<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SwiftUI Chapter 11: Lists, Sections, and Data Sources</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .presentation-container {
            width: 95%;
            max-width: 1200px;
            height: 90vh;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .header {
            background: linear-gradient(90deg, #FF6B6B, #4ECDC4);
            color: white;
            padding: 20px;
            text-align: center;
            position: relative;
        }

        .page-counter {
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255,255,255,0.2);
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: bold;
        }

        .content-area { flex: 1; display: flex; overflow: hidden; }
        .main-content { flex: 1; padding: 30px; overflow-y: auto; }
        .simulator { width: 350px; background: #f8f9fa; border-left: 2px solid #e9ecef; padding: 20px; overflow-y: auto; }

        .page { display: none; animation: slideIn 0.5s ease-out; }
        .page.active { display: block; }
        @keyframes slideIn { from { opacity: 0; transform: translateX(20px); } to { opacity: 1; transform: translateX(0); } }

        .navigation {
            display: flex; justify-content: space-between; align-items: center;
            padding: 20px; background: #f8f9fa; border-top: 1px solid #e9ecef;
        }
        .nav-btn {
            background: linear-gradient(45deg, #667eea, #764ba2); color: white; border: none;
            padding: 12px 24px; border-radius: 25px; cursor: pointer; font-weight: bold; transition: all 0.3s ease;
        }
        .nav-btn:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0,0,0,0.2); }
        .nav-btn:disabled { background: #ccc; cursor: not-allowed; transform: none; box-shadow: none; }

        .code-block {
            background: #1e1e1e; color: #d4d4d4; padding: 20px; border-radius: 10px; margin: 15px 0;
            font-family: 'Monaco','Menlo', monospace; font-size: 14px; line-height: 1.5; overflow-x: auto;
        }
        .code-block .keyword { color: #569cd6; }
        .code-block .string { color: #ce9178; }
        .code-block .type { color: #4ec9b0; }
        .code-block .property { color: #9cdcfe; }
        .code-block .comment { color: #6a9955; }

        .definition-box {
            background: linear-gradient(135deg, #ffeef7, #e8f4ff);
            border-left: 4px solid #FF6B6B; padding: 20px; margin: 15px 0; border-radius: 8px;
        }
        .definition-box h3 { color: #FF6B6B; margin-bottom: 10px; }

        .simulator-phone { background: #000; border-radius: 30px; padding: 20px; margin: 20px 0; color: white; min-height: 400px; }

        .practice-exercise { background: #fff3cd; border: 1px solid #ffeaa7; padding: 20px; border-radius: 10px; margin: 15px 0; }
        .exercise-title { color: #d63031; font-weight: bold; margin-bottom: 10px; }

        .sim-list-container { margin: 10px 0; }
        .sim-list { background: #fff; border: 1px solid #d1d5db; border-radius: 8px; max-height: 200px; overflow-y: auto; }
        .sim-list-item { padding: 12px; border-bottom: 1px solid #e9ecef; cursor: pointer; transition: background 0.2s; }
        .sim-list-item:hover, .sim-list-item.selected { background: #007AFF; color: white; }
        .sim-section-header { background: #4ECDC4; color: white; padding: 10px; font-weight: bold; border-top: 1px solid #e9ecef; }
        .sim-display { font-size: 16px; text-align: center; margin: 20px 0; color: #4ECDC4; font-weight: bold; }
        .sim-button { background: #007AFF; color: white; border: none; padding: 12px 24px; border-radius: 8px; margin: 10px 0; cursor: pointer; font-size: 16px; width: 100%; }

        .lms-header { background-color: #2d3748; color: white; padding: 10px 20px; display: flex; align-items: center; justify-content: space-between; border-top-left-radius: 10px; border-top-right-radius: 10px; }
        .lms-title { display: flex; align-items: center; }
        .lms-icon { margin-right: 10px; }
        .lms-date { font-size: 0.8em; opacity: 0.8; }
        .lms-gear { cursor: pointer; }

        .role-selection { text-align: center; padding: 50px 0; }
        .role-title { font-size: 2em; color: #2d3748; margin-bottom: 10px; }
        .role-subtitle { color: #4a5568; margin-bottom: 40px; }
        .role-buttons { display: flex; justify-content: center; gap: 20px; }
        .student-btn { background-color: #48bb78; color: white; padding: 15px 30px; border-radius: 30px; font-size: 1.2em; cursor: pointer; display: flex; align-items: center; text-align: center; }
        .instructor-btn { background-color: #4299e1; color: white; padding: 15px 30px; border-radius: 30px; font-size: 1.2em; cursor: pointer; display: flex; align-items: center; text-align: center; }
        .btn-icon { margin-right: 10px; }

        .lms-container { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; height: 100%; }
        .faculty-panel, .student-panel { background: white; border-radius: 15px; padding: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        .faculty-panel { background: linear-gradient(135deg, #ff9a9e, #fecfef); }
        .student-panel { background: linear-gradient(135deg, #a8edea, #fed6e3); }

        .hidden { display: none !important; }

        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; margin-bottom: 5px; font-weight: bold; color: #333; }
        .form-group input, .form-group select { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; font-size: 14px; }

        .quiz-status { padding: 15px; border-radius: 10px; margin: 10px 0; text-align: center; font-weight: bold; }
        .status-pending { background: #ffeaa7; color: #d63031; }
        .status-active { background: #00b894; color: white; }
        .status-ended { background: #e17055; color: white; }

        .timer { font-size: 24px; text-align: center; color: #d63031; font-weight: bold; margin: 20px 0; }

        .quiz-content { background: white; padding: 20px; border-radius: 10px; margin: 15px 0; }
        .question { margin-bottom: 20px; }
        .question h4 { margin-bottom: 10px; color: #333; }
        .options { list-style: none; }
        .options li { margin: 8px 0; }
        .options input[type="radio"] { margin-right: 10px; }

        .submit-btn { background: #00b894; color: white; border: none; padding: 12px 30px; border-radius: 8px; cursor: pointer; font-size: 16px; font-weight: bold; width: 100%; margin-top: 20px; }

        .analytics { background: white; padding: 15px; border-radius: 10px; margin: 15px 0; }
        .analytics h4 { color: #333; margin-bottom: 10px; }

        .progress-bar { width: 100%; height: 20px; background: #e9ecef; border-radius: 10px; overflow: hidden; margin: 10px 0; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, #00b894, #00cec9); transition: width 0.3s ease; }

        .download-btn { background: #007AFF; color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-size: 16px; margin: 10px 0; text-align: center; }

        .canvas-container { margin: 20px 0; text-align: center; }
        canvas { border: 1px solid #ddd; border-radius: 8px; }
    </style>
</head>
<body>
    <div class="presentation-container">
        <div class="header">
            <h1>SwiftUI Chapter 11: Lists, Sections, and Data Sources</h1>
            <div class="page-counter">
                <span id="currentPage">1</span> / 10
            </div>
        </div>

        <div class="content-area">
            <div class="main-content">
                <!-- Page 1: Introduction to Sections and Data Sources -->
                <div class="page active" id="page1">
                    <h2>Part 1: Lists with Sections and Data Sources</h2>
                    <div class="definition-box">
                        <h3>What are Sections and Data Sources?</h3>
                        <p><strong>Sections</strong> group related items in a List for better organization. <strong>Data Sources</strong> manage dynamic data, often fetched from external sources like APIs or local storage.</p>
                    </div>
                    <h3>What You'll Learn in Part 1:</h3>
                    <ul style="margin: 20px 0; padding-left: 30px; line-height: 2;">
                        <li>Using <span class="keyword">Section</span> in Lists</li>
                        <li>Managing data with <span class="keyword">@State</span> and <span class="keyword">@EnvironmentObject</span></li>
                        <li>Simulating data fetching with a mock data source</li>
                        <li>Applying UX principles for mobile list navigation</li>
                    </ul>
                    <div style="background: #e8f4ff; padding: 20px; border-radius: 10px; margin-top: 30px;">
                        <h4 style="color: #0066cc;">💡 Key Concept</h4>
                        <p>Sections enhance List readability, while dynamic data sources enable real-world app functionality like fetching destinations and points of interest.</p>
                    </div>
                </div>

                <!-- Page 2: Basic Sections in Lists -->
                <div class="page" id="page2">
                    <h2>Creating Sections in Lists</h2>
                    <div class="definition-box">
                        <h3>Section Definition</h3>
                        <p><strong>Section</strong> organizes List items into collapsible or visually distinct groups, often with headers and footers.</p>
                    </div>
                    <h3>Basic Section Syntax:</h3>
                    <div class="code-block">
                        <span class="keyword">import</span> SwiftUI<br><br>
                        <span class="keyword">struct</span> <span class="type">SectionListView</span>: <span class="type">View</span> {<br>
                            <span class="keyword">var</span> <span class="property">body</span>: <span class="keyword">some</span> <span class="type">View</span> {<br>
                                <span class="type">List</span> {<br>
                                    <span class="type">Section</span>(header: <span class="type">Text</span>(<span class="string">"Seattle"</span>)) {<br>
                                        <span class="type">Text</span>(<span class="string">"Pike Place Market"</span>)<br>
                                        <span class="type">Text</span>(<span class="string">"Space Needle"</span>)<br>
                                    }<br>
                                    <span class="type">Section</span>(header: <span class="type">Text</span>(<span class="string">"Austin"</span>)) {<br>
                                        <span class="type">Text</span>(<span class="string">"Lady Bird Lake"</span>)<br>
                                        <span class="type">Text</span>(<span class="string">"Zilker Park"</span>)<br>
                                    }<br>
                                }<br>
                                .<span class="property">listStyle</span>(.<span class="property">insetGrouped</span>)<br>
                            }<br>
                        }
                    </div>
                    <h3>Key Components:</h3>
                    <ul style="margin: 20px 0; padding-left: 30px; line-height: 2;">
                        <li><strong>Section</strong> - Groups items with optional header/footer</li>
                        <li><strong>listStyle</strong> - Enhances section appearance</li>
                        <li><strong>Text</strong> - Displays section headers</li>
                    </ul>
                    <div class="practice-exercise">
                        <div class="exercise-title">🏋️ Practice Exercise</div>
                        <p>Create a List with two sections for two cities (e.g., Seattle and Austin), each containing three attractions.</p>
                    </div>
                </div>

                <!-- Page 3: Navigation with Sections -->
                <div class="page" id="page3">
                    <h2>Navigation with Sections</h2>
                    <div class="definition-box">
                        <h3>Section Navigation</h3>
                        <p>Combine <span class="keyword">Section</span> with <span class="keyword">NavigationLink</span> for navigable grouped lists.</p>
                    </div>
                    <h3>Navigation Section Syntax:</h3>
                    <div class="code-block">
                        <span class="keyword">import</span> SwiftUI<br><br>
                        <span class="keyword">struct</span> <span class="type">NavSectionListView</span>: <span class="type">View</span> {<br>
                            <span class="keyword">var</span> <span class="property">body</span>: <span class="keyword">some</span> <span class="type">View</span> {<br>
                                <span class="type">NavigationView</span> {<br>
                                    <span class="type">List</span> {<br>
                                        <span class="type">Section</span>(header: <span class="type">Text</span>(<span class="string">"Seattle"</span>)) {<br>
                                            <span class="type">NavigationLink</span>(destination: <span class="type">Text</span>(<span class="string">"Pike Place Market Details"</span>)) {<br>
                                                <span class="type">Text</span>(<span class="string">"Pike Place Market"</span>)<br>
                                            }<br>
                                            <span class="type">NavigationLink</span>(destination: <span class="type">Text</span>(<span class="string">"Space Needle Details"</span>)) {<br>
                                                <span class="type">Text</span>(<span class="string">"Space Needle"</span>)<br>
                                            }<br>
                                        }<br>
                                        <span class="type">Section</span>(header: <span class="type">Text</span>(<span class="string">"Austin"</span>)) {<br>
                                            <span class="type">NavigationLink</span>(destination: <span class="type">Text</span>(<span class="string">"Lady Bird Lake Details"</span>)) {<br>
                                                <span class="type">Text</span>(<span class="string">"Lady Bird Lake"</span>)<br>
                                            }<br>
                                        }<br>
                                    }<br>
                                    .<span class="property">navigationTitle</span>(<span class="string">"City Guide"</span>)<br>
                                    .<span class="property">listStyle</span>(.<span class="property">insetGrouped</span>)<br>
                                }<br>
                            }<br>
                        }
                    </div>
                    <h3>Key Features:</h3>
                    <ul style="margin: 20px 0; padding-left: 30px; line-height: 2;">
                        <li><strong>NavigationView</strong> - Enables navigation stack</li>
                        <li><strong>NavigationLink</strong> - Links to detail views</li>
                        <li><strong>Section</strong> - Organizes navigation items</li>
                    </ul>
                    <div class="practice-exercise">
                        <div class="exercise-title">🎨 Practice Exercise</div>
                        <p>Create a List with sections for two cities, each with navigable attractions.</p>
                    </div>
                </div>

                <!-- Page 4: Dynamic Sections with Data Model -->
                <div class="page" id="page4">
                    <h2>Dynamic Sections with Data Model</h2>
                    <div class="definition-box">
                        <h3>Dynamic Sections</h3>
                        <p>Use <span class="keyword">@State</span> and a data model to create dynamic sections for grouped data.</p>
                    </div>
                    <h3>Dynamic Section Code:</h3>
                    <div class="code-block">
                        <span class="keyword">import</span> SwiftUI<br><br>
                        <span class="keyword">struct</span> <span class="type">Attraction</span>: <span class="type">Identifiable</span> {<br>
                            <span class="keyword">let</span> id = <span class="type">UUID</span>()<br>
                            <span class="keyword">var</span> name: <span class="type">String</span><br>
                        }<br><br>
                        <span class="keyword">struct</span> <span class="type">City</span>: <span class="type">Identifiable</span> {<br>
                            <span class="keyword">let</span> id = <span class="type">UUID</span>()<br>
                            <span class="keyword">var</span> name: <span class="type">String</span><br>
                            <span class="keyword">var</span> attractions: [<span class="type">Attraction</span>]<br>
                        }<br><br>
                        <span class="keyword">struct</span> <span class="type">DynamicSectionListView</span>: <span class="type">View</span> {<br>
                            <span class="keyword">@State</span> <span class="keyword">private</span> <span class="keyword">var</span> cities = [<br>
                                <span class="type">City</span>(name: <span class="string">"Seattle"</span>, attractions: [<br>
                                    <span class="type">Attraction</span>(name: <span class="string">"Pike Place Market"</span>),<br>
                                    <span class="type">Attraction</span>(name: <span class="string">"Space Needle"</span>)<br>
                                ]),<br>
                                <span class="type">City</span>(name: <span class="string">"Austin"</span>, attractions: [<br>
                                    <span class="type">Attraction</span>(name: <span class="string">"Lady Bird Lake"</span>),<br>
                                    <span class="type">Attraction</span>(name: <span class="string">"Zilker Park"</span>)<br>
                                ])<br>
                            ]<br><br>
                            <span class="keyword">var</span> <span class="property">body</span>: <span class="keyword">some</span> <span class="type">View</span> {<br>
                                <span class="type">NavigationView</span> {<br>
                                    <span class="type">List</span> {<br>
                                        <span class="type">ForEach</span>(cities) { city <span class="keyword">in</span><br>
                                            <span class="type">Section</span>(header: <span class="type">Text</span>(city.name)) {<br>
                                                <span class="type">ForEach</span>(city.attractions) { attraction <span class="keyword">in</span><br>
                                                    <span class="type">NavigationLink</span>(destination: <span class="type">Text</span>(<span class="string">"Details for \(attraction.name)"</span>)) {<br>
                                                        <span class="type">Text</span>(attraction.name)<br>
                                                    }<br>
                                                }<br>
                                                .<span class="property">onDelete</span>(perform: { offsets in deleteAttraction(in: city, at: offsets) })<br>
                                            }<br>
                                        }<br>
                                    }<br>
                                    .<span class="property">navigationTitle</span>(<span class="string">"City Guide"</span>)<br>
                                    .<span class="property">listStyle</span>(.<span class="property">insetGrouped</span>)<br>
                                    .<span class="property">toolbar</span> {<br>
                                        <span class="type">ToolbarItem</span> {<br>
                                            <span class="type">Button</span>(<span class="string">"Add City"</span>) { addCity() }<br>
                                        }<br>
                                    }<br>
                                }<br>
                            }<br><br>
                            <span class="keyword">private</span> <span class="keyword">func</span> addCity() {<br>
                                cities.append(<span class="type">City</span>(name: <span class="string">"New City"</span>, attractions: []))<br>
                            }<br><br>
                            <span class="keyword">private</span> <span class="keyword">func</span> deleteAttraction(in city: <span class="type">City</span>, at offsets: <span class="type">IndexSet</span>) {<br>
                                <span class="keyword">if let</span> index = cities.firstIndex(where: { $0.id == city.id }) {<br>
                                    cities[index].attractions.remove(atOffsets: offsets)<br>
                                }<br>
                            }<br>
                        }
                    </div>
                    <div class="practice-exercise">
                        <div class="exercise-title">🛒 Practice Exercise</div>
                        <p>Create a List with dynamic sections for two cities, each with editable attractions.</p>
                    </div>
                    <button class="download-btn" onclick="downloadDynamicSectionCode()">Download Dynamic Section Code</button>
                </div>

                <!-- Page 5: Mock Data Source -->
                <div class="page" id="page5">
                    <h2>Mock Data Source with 'from'</h2>
                    <div class="definition-box">
                        <h3>Data Source</h3>
                        <p>Simulate fetching data <strong>from</strong> an external source (e.g., API) using a mock data provider.</p>
                    </div>
                    <h3>Mock Data Source Code:</h3>
                    <div class="code-block">
                        <span class="keyword">import</span> SwiftUI<br><br>
                        <span class="keyword">class</span> <span class="type">CityDataSource</span>: <span class="type">ObservableObject</span> {<br>
                            <span class="keyword">@Published</span> <span class="keyword">var</span> cities: [<span class="type">City</span>] = []<br><br>
                            <span class="keyword">func</span> fetchCities() {<br>
                                <span class="comment">// Simulate API call</span><br>
                                cities = [<br>
                                    <span class="type">City</span>(name: <span class="string">"Seattle"</span>, attractions: [<br>
                                        <span class="type">Attraction</span>(name: <span class="string">"Pike Place Market"</span>),<br>
                                        <span class="type">Attraction</span>(name: <span class="string">"Space Needle"</span>)<br>
                                    ]),<br>
                                    <span class="type">City</span>(name: <span class="string">"Austin"</span>, attractions: [<br>
                                        <span class="type">Attraction</span>(name: <span class="string">"Lady Bird Lake"</span>),<br>
                                        <span class="type">Attraction</span>(name: <span class="string">"Zilker Park"</span>)<br>
                                    ])<br>
                                ]<br>
                            }<br>
                        }<br><br>
                        <span class="keyword">struct</span> <span class="type">City</span>: <span class="type">Identifiable</span> {<br>
                            <span class="keyword">let</span> id = <span class="type">UUID</span>()<br>
                            <span class="keyword">var</span> name: <span class="type">String</span><br>
                            <span class="keyword">var</span> attractions: [<span class="type">Attraction</span>]<br>
                        }<br><br>
                        <span class="keyword">struct</span> <span class="type">Attraction</span>: <span class="type">Identifiable</span> {<br>
                            <span class="keyword">let</span> id = <span class="type">UUID</span>()<br>
                            <span class="keyword">var</span> name: <span class="type">String</span><br>
                        }<br><br>
                        <span class="keyword">struct</span> <span class="type">DataSourceListView</span>: <span class="type">View</span> {<br>
                            <span class="keyword">@EnvironmentObject</span> <span class="keyword">var</span> dataSource: <span class="type">CityDataSource</span><br><br>
                            <span class="keyword">var</span> <span class="property">body</span>: <span class="keyword">some</span> <span class="type">View</span> {<br>
                                <span class="type">NavigationView</span> {<br>
                                    <span class="type">List</span> {<br>
                                        <span class="type">ForEach</span>(dataSource.cities) { city <span class="keyword">in</span><br>
                                            <span class="type">Section</span>(header: <span class="type">Text</span>(city.name)) {<br>
                                                <span class="type">ForEach</span>(city.attractions) { attraction <span class="keyword">in</span><br>
                                                    <span class="type">Text</span>(attraction.name)<br>
                                                }<br>
                                            }<br>
                                        }<br>
                                    }<br>
                                    .<span class="property">navigationTitle</span>(<span class="string">"City Guide"</span>)<br>
                                    .<span class="property">listStyle</span>(.<span class="property">insetGrouped</span>)<br>
                                    .<span class="property">onAppear</span> {<br>
                                        dataSource.fetchCities()<br>
                                    }<br>
                                }<br>
                            }<br>
                        }
                    </div>
                    <h3>Key Components:</h3>
                    <ul style="margin: 20px 0; padding-left: 30px; line-height: 2;">
                        <li><strong>ObservableObject</strong> - Publishes data changes</li>
                        <li><strong>@Published</strong> - Updates views on data change</li>
                        <li><strong>@EnvironmentObject</strong> - Shares data across views</li>
                    </ul>
                    <div class="practice-exercise">
                        <div class="exercise-title">🔄 Practice Exercise</div>
                        <p>Create a mock data source for two cities and display attractions in sections.</p>
                    </div>
                </div>

                <!-- Page 6: Filtering Data Source -->
                <div class="page" id="page6">
                    <h2>Filtering Data Source</h2>
                    <div class="definition-box">
                        <h3>Data Filtering</h3>
                        <p>Filter data <strong>from</strong> a source based on user input, such as a search query.</p>
                    </div>
                    <h3>Filtered Data Source Code:</h3>
                    <div class="code-block">
                        <span class="keyword">import</span> SwiftUI<br><br>
                        <span class="keyword">class</span> <span class="type">CityDataSource</span>: <span class="type">ObservableObject</span> {<br>
                            <span class="keyword">@Published</span> <span class="keyword">var</span> cities: [<span class="type">City</span>] = [<br>
                                <span class="type">City</span>(name: <span class="string">"Seattle"</span>, attractions: [<br>
                                    <span class="type">Attraction</span>(name: <span class="string">"Pike Place Market"</span>),<br>
                                    <span class="type">Attraction</span>(name: <span class="string">"Space Needle"</span>)<br>
                                ]),<br>
                                <span class="type">City</span>(name: <span class="string">"Austin"</span>, attractions: [<br>
                                    <span class="type">Attraction</span>(name: <span class="string">"Lady Bird Lake"</span>),<br>
                                    <span class="type">Attraction</span>(name: <span class="string">"Zilker Park"</span>)<br>
                                ])<br>
                            ]<br><br>
                            <span class="keyword">func</span> filterCities(searchText: <span class="type">String</span>) -> [<span class="type">City</span>] {<br>
                                <span class="keyword">if</span> searchText.<span class="property">isEmpty</span> {<br>
                                    <span class="keyword">return</span> cities<br>
                                } <span class="keyword">else</span> {<br>
                                    <span class="keyword">return</span> cities.map { city <span class="keyword">in</span><br>
                                        <span class="type">City</span>(name: city.name, attractions: city.attractions.<span class="property">filter</span> { <br>
                                            $0.name.<span class="property">lowercased</span>().<span class="property">contains</span>(searchText.<span class="property">lowercased</span>()) <br>
                                        })<br>
                                    }.<span class="property">filter</span> { !$0.attractions.<span class="property">isEmpty</span> }<br>
                                }<br>
                            }<br>
                        }<br><br>
                        <span class="keyword">struct</span> <span class="type">FilteredListView</span>: <span class="type">View</span> {<br>
                            <span class="keyword">@EnvironmentObject</span> <span class="keyword">var</span> dataSource: <span class="type">CityDataSource</span><br>
                            <span class="keyword">@State</span> <span class="keyword">private</span> <span class="keyword">var</span> searchText = <span class="string">""</span><br><br>
                            <span class="keyword">var</span> <span class="property">body</span>: <span class="keyword">some</span> <span class="type">View</span> {<br>
                                <span class="type">NavigationView</span> {<br>
                                    <span class="type">List</span> {<br>
                                        <span class="type">TextField</span>(<span class="string">"Search attractions"</span>, text: $searchText)<br>
                                        <span class="type">ForEach</span>(dataSource.filterCities(searchText: searchText)) { city <span class="keyword">in</span><br>
                                            <span class="type">Section</span>(header: <span class="type">Text</span>(city.name)) {<br>
                                                <span class="type">ForEach</span>(city.attractions) { attraction <span class="keyword">in</span><br>
                                                    <span class="type">Text</span>(attraction.name)<br>
                                                }<br>
                                            }<br>
                                        }<br>
                                    }<br>
                                    .<span class="property">navigationTitle</span>(<span class="string">"City Guide"</span>)<br>
                                    .<span class="property">listStyle</span>(.<span class="property">insetGrouped</span>)<br>
                                }<br>
                            }<br>
                        }
                    </div>
                    <div class="practice-exercise">
                        <div class="exercise-title">🔍 Practice Exercise</div>
                        <p>Add a search bar to filter attractions in a sectioned List of two cities.</p>
                    </div>
                </div>

                <!-- Page 7: City Guide Sectioned List -->
                <div class="page" id="page7">
                    <h2>City Guide: Sectioned List Implementation</h2>
                    <div class="definition-box">
                        <h3>City Guide Sections</h3>
                        <p>Use sections to organize attractions by city in a City Guide app.</p>
                    </div>
                    <h3>City Guide Sectioned List Code:</h3>
                    <div class="code-block">
                        <span class="keyword">import</span> SwiftUI<br><br>
                        <span class="keyword">struct</span> <span class="type">CityGuideSectionListView</span>: <span class="type">View</span> {<br>
                            <span class="keyword">@State</span> <span class="keyword">private</span> <span class="keyword">var</span> cities = [<br>
                                <span class="type">City</span>(name: <span class="string">"Seattle"</span>, attractions: [<br>
                                    <span class="type">Attraction</span>(name: <span class="string">"Pike Place Market"</span>),<br>
                                    <span class="type">Attraction</span>(name: <span class="string">"Space Needle"</span>)<br>
                                ]),<br>
                                <span class="type">City</span>(name: <span class="string">"Austin"</span>, attractions: [<br>
                                    <span class="type">Attraction</span>(name: <span class="string">"Lady Bird Lake"</span>),<br>
                                    <span class="type">Attraction</span>(name: <span class="string">"Zilker Park"</span>)<br>
                                ])<br>
                            ]<br><br>
                            <span class="keyword">var</span> <span class="property">body</span>: <span class="keyword">some</span> <span class="type">View</span> {<br>
                                <span class="type">NavigationView</span> {<br>
                                    <span class="type">List</span> {<br>
                                        <span class="type">ForEach</span>(cities) { city <span class="keyword">in</span><br>
                                            <span class="type">Section</span>(header: <span class="type">Text</span>(city.name).<span class="property">font</span>(.<span class="property">title2</span>)) {<br>
                                                <span class="type">ForEach</span>(city.attractions) { attraction <span class="keyword">in</span><br>
                                                    <span class="type">NavigationLink</span>(destination: <span class="type">Text</span>(<span class="string">"Explore \(attraction.name)"</span>)) {<br>
                                                        <span class="type">Text</span>(attraction.name)<br>
                                                    }<br>
                                                }<br>
                                            }<br>
                                        }<br>
                                    }<br>
                                    .<span class="property">navigationTitle</span>(<span class="string">"City Guide"</span>)<br>
                                    .<span class="property">listStyle</span>(.<span class="property">insetGrouped</span>)<br>
                                }<br>
                            }<br>
                        }<br><br>
                        <span class="keyword">struct</span> <span class="type">City</span>: <span class="type">Identifiable</span> {<br>
                            <span class="keyword">let</span> id = <span class="type">UUID</span>()<br>
                            <span class="keyword">var</span> name: <span class="type">String</span><br>
                            <span class="keyword">var</span> attractions: [<span class="type">Attraction</span>]<br>
                        }<br><br>
                        <span class="keyword">struct</span> <span class="type">Attraction</span>: <span class="type">Identifiable</span> {<br>
                            <span class="keyword">let</span> id = <span class="type">UUID</span>()<br>
                            <span class="keyword">var</span> name: <span class="type">String</span><br>
                        }
                    </div>
                    <div class="practice-exercise">
                        <div class="exercise-title">🗺 Practice Exercise</div>
                        <p>Create a sectioned List for two cities with navigable attractions.</p>
                    </div>
                    <button class="download-btn" onclick="downloadCityGuideSectionCode()">Download City Guide Section Code</button>
                </div>

                <!-- Page 8: Styling Sections -->
                <div class="page" id="page8">
                    <h2>Styling Sections</h2>
                    <div class="definition-box">
                        <h3>Section Styling</h3>
                        <p>Customize section headers and items with view modifiers for enhanced UX.</p>
                    </div>
                    <h3>Styled Section Code:</h3>
                    <div class="code-block">
                        <span class="keyword">import</span> SwiftUI<br><br>
                        <span class="keyword">struct</span> <span class="type">StyledSectionListView</span>: <span class="type">View</span> {<br>
                            <span class="keyword">@State</span> <span class="keyword">private</span> <span class="keyword">var</span> cities = [<br>
                                <span class="type">City</span>(name: <span class="string">"Seattle"</span>, attractions: [<br>
                                    <span class="type">Attraction</span>(name: <span class="string">"Pike Place Market"</span>),<br>
                                    <span class="type">Attraction</span>(name: <span class="string">"Space Needle"</span>)<br>
                                ]),<br>
                                <span class="type">City</span>(name: <span class="string">"Austin"</span>, attractions: [<br>
                                    <span class="type">Attraction</span>(name: <span class="string">"Lady Bird Lake"</span>),<br>
                                    <span class="type">Attraction</span>(name: <span class="string">"Zilker Park"</span>)<br>
                                ])<br>
                            ]<br><br>
                            <span class="keyword">var</span> <span class="property">body</span>: <span class="keyword">some</span> <span class="type">View</span> {<br>
                                <span class="type">List</span> {<br>
                                    <span class="type">ForEach</span>(cities) { city <span class="keyword">in</span><br>
                                        <span class="type">Section</span>(header: <br>
                                            <span class="type">Text</span>(city.name)<br>
                                                .<span class="property">font</span>(.<span class="property">title2</span>)<br>
                                                .<span class="property">foregroundColor</span>(.<span class="property">blue</span>)<br>
                                                .<span class="property">padding</span>()<br>
                                                .<span class="property">background</span>(<span class="type">Color</span>.<span class="property">gray</span>.<span class="property">opacity</span>(0.2))<br>
                                                .<span class="property">cornerRadius</span>(10)<br>
                                        ) {<br>
                                            <span class="type">ForEach</span>(city.attractions) { attraction <span class="keyword">in</span><br>
                                                <span class="type">HStack</span> {<br>
                                                    <span class="type">Image</span>(systemName: <span class="string">"star.fill"</span>)<br>
                                                        .<span class="property">foregroundColor</span>(.<span class="property">yellow</span>)<br>
                                                    <span class="type">Text</span>(attraction.name)<br>
                                                    <span class="type">Spacer</span>()<br>
                                                    <span class="type">Image</span>(systemName: <span class="string">"chevron.right"</span>)<br>
                                                }<br>
                                                .<span class="property">padding</span>()<br>
                                                .<span class="property">background</span>(<span class="type">Color</span>.<span class="property">blue</span>.<span class="property">opacity</span>(0.1))<br>
                                                .<span class="property">cornerRadius</span>(8)<br>
                                            }<br>
                                        }<br>
                                    }<br>
                                }<br>
                                .<span class="property">listStyle</span>(.<span class="property">insetGrouped</span>)<br>
                            }<br>
                        }<br><br>
                        <span class="keyword">struct</span> <span class="type">City</span>: <span class="type">Identifiable</span> {<br>
                            <span class="keyword">let</span> id = <span class="type">UUID</span>()<br>
                            <span class="keyword">var</span> name: <span class="type">String</span><br>
                            <span class="keyword">var</span> attractions: [<span class="type">Attraction</span>]<br>
                        }<br><br>
                        <span class="keyword">struct</span> <span class="type">Attraction</span>: <span class="type">Identifiable</span> {<br>
                            <span class="keyword">let</span> id = <span class="type">UUID</span>()<br>
                            <span class="keyword">var</span> name: <span class="type">String</span><br>
                        }
                    </div>
                    <div class="practice-exercise">
                        <div class="exercise-title">🎨 Practice Exercise</div>
                        <p>Style a sectioned List with custom headers and icons for a City Guide app.</p>
                    </div>
                </div>

                <!-- Page 9: Interactive Simulator -->
                <div class="page" id="page9">
                    <h2>Interactive Simulator: Sectioned List</h2>
                    <div class="definition-box">
                        <h3>Simulator Overview</h3>
                        <p>Test a sectioned List or run code in <a href="https://swiftfiddle.com" target="_blank" style="color: #0066cc;">SwiftFiddle</a>.</p>
                    </div>
                    <h3>Simulator Sectioned List Code:</h3>
                    <div class="code-block">
                        <span class="keyword">import</span> SwiftUI<br><br>
                        <span class="keyword">struct</span> <span class="type">City</span>: <span class="type">Identifiable</span> {<br>
                            <span class="keyword">let</span> id = <span class="type">UUID</span>()<br>
                            <span class="keyword">var</span> name: <span class="type">String</span><br>
                            <span class="keyword">var</span> attractions: [<span class="type">Attraction</span>]<br>
                        }<br><br>
                        <span class="keyword">struct</span> <span class="type">Attraction</span>: <span class="type">Identifiable</span> {<br>
                            <span class="keyword">let</span> id = <span class="type">UUID</span>()<br>
                            <span class="keyword">var</span> name: <span class="type">String</span><br>
                        }<br><br>
                        <span class="keyword">struct</span> <span class="type">SimulatorSectionListView</span>: <span class="type">View</span> {<br>
                            <span class="keyword">@State</span> <span class="keyword">private</span> <span class="keyword">var</span> cities = [<br>
                                <span class="type">City</span>(name: <span class="string">"Seattle"</span>, attractions: [<br>
                                    <span class="type">Attraction</span>(name: <span class="string">"Pike Place Market"</span>),<br>
                                    <span class="type">Attraction</span>(name: <span class="string">"Space Needle"</span>)<br>
                                ]),<br>
                                <span class="type">City</span>(name: <span class="string">"Austin"</span>, attractions: [<br>
                                    <span class="type">Attraction</span>(name: <span class="string">"Lady Bird Lake"</span>),<br>
                                    <span class="type">Attraction</span>(name: <span class="string">"Zilker Park"</span>)<br>
                                ])<br>
                            ]<br><br>
                            <span class="keyword">var</span> <span class="property">body</span>: <span class="keyword">some</span> <span class="type">View</span> {<br>
                                <span class="type">NavigationView</span> {<br>
                                    <span class="type">List</span> {<br>
                                        <span class="type">ForEach</span>(cities) { city <span class="keyword">in</span><br>
                                            <span class="type">Section</span>(header: <span class="type">Text</span>(city.name)) {<br>
                                                <span class="type">ForEach</span>(city.attractions) { attraction <span class="keyword">in</span><br>
                                                    <span class="type">NavigationLink</span>(destination: <span class="type">Text</span>(<span class="string">"Explore \(attraction.name)"</span>)) {<br>
                                                        <span class="type">Text</span>(attraction.name)<br>
                                                    }<br>
                                                }<br>
                                                .<span class="property">onDelete</span>(perform: { offsets in deleteAttraction(in: city, at: offsets) })<br>
                                            }<br>
                                        }<br>
                                    }<br>
                                    .<span class="property">navigationTitle</span>(<span class="string">"City Guide"</span>)<br>
                                    .<span class="property">listStyle</span>(.<span class="property">insetGrouped</span>)<br>
                                    .<span class="property">toolbar</span> {<br>
                                        <span class="type">ToolbarItem</span> {<br>
                                            <span class="type">Button</span>(<span class="string">"Add City"</span>) { addCity() }<br>
                                        }<br>
                                    }<br>
                                }<br>
                            }<br><br>
                            <span class="keyword">private</span> <span class="keyword">func</span> addCity() {<br>
                                cities.append(<span class="type">City</span>(name: <span class="string">"New City"</span>, attractions: []))<br>
                            }<br><br>
                            <span class="keyword">private</span> <span class="keyword">func</span> deleteAttraction(in city: <span class="type">City</span>, at offsets: <span class="type">IndexSet</span>) {<br>
                                <span class="keyword">if let</span> index = cities.firstIndex(where: { $0.id == city.id }) {<br>
                                    cities[index].attractions.remove(atOffsets: offsets)<br>
                                }<br>
                            }<br>
                        }
                    </div>
                    <button class="download-btn" onclick="downloadSimulatorSectionCode()">Download Simulator Section Code</button>
                </div>

                <!-- Page 10: Learning Management System -->
                <div class="page" id="page10">
                    <div class="lms-header">
                        <div class="lms-title">
                            <span class="lms-icon">📚</span>
                            SwiftUI Learning Management System - Chapter 11 Assessment
                        </div>
                        <div class="lms-date" id="lmsDate"></div>
                        <div class="lms-gear" onclick="toggleSettings()">⚙️</div>
                    </div>

                    <div id="roleSelection">
                        <div class="role-title">Welcome to SwiftUI Lists and Sections Assessment</div>
                        <div class="role-subtitle">Please select your role to continue</div>
                        <div class="role-buttons">
                            <div class="student-btn" onclick="selectStudentRole()">
                                <span class="btn-icon">🎓</span>
                                Student<br>Take Assessment
                            </div>
                            <div class="instructor-btn" onclick="selectInstructorRole()">
                                <span class="btn-icon">👨‍🏫</span>
                                Instructor<br>View Dashboard
                            </div>
                        </div>
                    </div>

                    <div id="lmsContainer" class="lms-container hidden">
                        <div id="facultyPanel" class="faculty-panel hidden">
                            <h3>Faculty Dashboard</h3>
                            <div id="settingsPanel" class="hidden">
                                <h4>Quiz Settings</h4>
                                <div class="form-group">
                                    <label>Quiz Title:</label>
                                    <input type="text" id="quizTitle" value="SwiftUI Lists and Sections Quiz" placeholder="Enter quiz title">
                                </div>
                                <div class="form-group">
                                    <label>Start Date:</label>
                                    <input type="datetime-local" id="startDate">
                                </div>
                                <div class="form-group">
                                    <label>End Date:</label>
                                    <input type="datetime-local" id="endDate">
                                </div>
                                <div class="form-group">
                                    <label>Duration (minutes):</label>
                                    <input type="number" id="duration" value="20" min="5" max="60">
                                </div>
                                <div class="form-group">
                                    <label>Access Password:</label>
                                    <input type="password" id="accessPassword" placeholder="Set quiz password">
                                </div>
                                <div class="form-group">
                                    <label>Instructor Password:</label>
                                    <input type="password" id="instructorCode" placeholder="Set instructor password">
                                </div>
                                <div class="form-group">
                                    <label>Max Attempts:</label>
                                    <select id="maxAttempts">
                                        <option value="1">1 Attempt</option>
                                        <option value="2">2 Attempts</option>
                                        <option value="3" selected>3 Attempts</option>
                                        <option value="unlimited">Unlimited</option>
                                    </select>
                                </div>
                                <button class="submit-btn" onclick="saveAssessmentSettings()">Save Settings</button>
                            </div>
                            <div class="analytics">
                                <h4>📊 Quiz Analytics</h4>
                                <p>Students Attempted: <span id="attemptCount">0</span></p>
                                <p>Average Score: <span id="averageScore">0%</span></p>
                                <p>Completion Rate: <span id="completionRate">0%</span></p>
                                <div class="progress-bar">
                                    <div class="progress-fill" id="progressFill" style="width: 0%"></div>
                                </div>
                            </div>
                            <div class="analytics">
                                <h4>🎯 Question Performance</h4>
                                <div class="canvas-container">
                                    <canvas id="questionChart" width="300" height="200"></canvas>
                                </div>
                                <div id="questionStats">
                                    <p>Q1 - Section Basics: 0% correct</p>
                                    <p>Q2 - Data Source: 0% correct</p>
                                    <p>Q3 - Filtering: 0% correct</p>
                                </div>
                            </div>
                            <div class="analytics">
                                <h4>👩‍🎓 Student Performance</h4>
                                <div id="studentStats">
                                    <p>No student data available.</p>
                                </div>
                            </div>
                        </div>
                        <div id="studentPanel" class="student-panel hidden">
                            <div id="loginSection">
                                <div class="form-group">
                                    <label>Student Name:</label>
                                    <input type="text" id="studentName" placeholder="Enter your name">
                                </div>
                                <div class="form-group">
                                    <label>Quiz Password:</label>
                                    <input type="password" id="studentPassword" placeholder="Enter quiz password">
                                </div>
                                <button class="submit-btn" onclick="startAssessment()">Access Quiz</button>
                            </div>
                            <div id="quizSection" class="hidden">
                                <div id="quizStatus" class="quiz-status status-pending">
                                    Quiz will be available soon
                                </div>
                                <div class="timer" id="timer">20:00</div>
                                <div class="quiz-content">
                                    <div class="question">
                                        <h4>Question 1: What is the purpose of Section in a SwiftUI List?</h4>
                                        <ul class="options">
                                            <li><input type="radio" name="q1" value="a"> Displays static text</li>
                                            <li><input type="radio" name="q1" value="b"> Groups related items</li>
                                            <li><input type="radio" name="q1" value="c"> Fetches API data</li>
                                            <li><input type="radio" name="q1" value="d"> Animates views</li>
                                        </ul>
                                    </div>
                                    <div class="question">
                                        <h4>Question 2: What is @EnvironmentObject used for in a data source?</h4>
                                        <ul class="options">
                                            <li><input type="radio" name="q2" value="a"> Styles the list</li>
                                            <li><input type="radio" name="q2" value="b"> Shares data across views</li>
                                            <li><input type="radio" name="q2" value="c"> Filters data</li>
                                            <li><input type="radio" name="q2" value="d"> Deletes items</li>
                                        </ul>
                                    </div>
                                    <div class="question">
                                        <h4>Question 3: How do you filter data in a List?</h4>
                                        <ul class="options">
                                            <li><input type="radio" name="q3" value="a"> Use onAppear</li>
                                            <li><input type="radio" name="q3" value="b"> Use a computed property</li>
                                            <li><input type="radio" name="q3" value="c"> Use listStyle</li>
                                            <li><input type="radio" name="q3" value="d"> Use swipeActions</li>
                                        </ul>
                                    </div>
                                </div>
                                <button class="submit-btn" onclick="submitAssessment()">Submit Quiz</button>
                            </div>
                            <div id="resultsSection" class="hidden">
                                <h4>Quiz Results</h4>
                                <div id="scoreDisplay" class="quiz-status status-active">
                                    Your Score: 0/3 (0%)
                                </div>
                                <div class="analytics">
                                    <h4>📈 Performance Breakdown</h4>
                                    <div id="detailedResults">
                                        <p>Q1: ✓ Correct</p>
                                        <p>Q2: ✗ Incorrect</p>
                                        <p>Q3: ✓ Correct</p>
                                    </div>
                                    <div style="margin-top: 15px;">
                                        <p><strong>Recommended Study Areas:</strong></p>
                                        <ul id="studyRecommendations" style="margin-left: 20px;">
                                            <li>Review Section basics</li>
                                            <li>Practice data sources</li>
                                        </ul>
                                    </div>
                                </div>
                                <button class="submit-btn" onclick="retakeAssessment()" id="retakeBtn">Retake Quiz</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Simulator -->
            <div class="simulator">
                <h3>📱 SwiftUI Simulator</h3>
                <div class="simulator-phone" id="simulatorContent">
                    <!-- Pages 1-8: Sectioned List Demo -->
                    <div class="sim-demo" id="sim1">
                        <h4 style="color: #4ECDC4; text-align: center;">Sectioned List Demo</h4>
                        <div class="sim-list-container">
                            <div class="sim-list" id="sectionList">
                                <div class="sim-section-header">Seattle</div>
                                <div class="sim-list-item selected" data-city="Seattle" data-value="Pike Place Market">Pike Place Market</div>
                                <div class="sim-list-item" data-city="Seattle" data-value="Space Needle">Space Needle</div>
                                <div class="sim-section-header">Austin</div>
                                <div class="sim-list-item" data-city="Austin" data-value="Lady Bird Lake">Lady Bird Lake</div>
                                <div class="sim-list-item" data-city="Austin" data-value="Zilker Park">Zilker Park</div>
                            </div>
                        </div>
                        <div class="sim-display" id="listDisplay">Selected: Pike Place Market</div>
                        <button class="sim-button" onclick="addAttraction()">Add Attraction</button>
                        <button class="sim-button" onclick="deleteAttraction()">Delete Selected</button>
                    </div>
                    <!-- Page 9: Dynamic Sectioned List Demo -->
                    <div class="sim-demo hidden" id="sim2">
                        <h4 style="color: #4ECDC4; text-align: center;">Dynamic Sectioned List Demo</h4>
                        <div class="sim-list-container">
                            <div class="sim-list" id="dynamicSectionList">
                                <div class="sim-section-header">Seattle</div>
                                <div class="sim-list-item selected" data-city="Seattle" data-value="Pike Place Market">Pike Place Market</div>
                                <div class="sim-list-item" data-city="Seattle" data-value="Space Needle">Space Needle</div>
                                <div class="sim-section-header">Austin</div>
                                <div class="sim-list-item" data-city="Austin" data-value="Lady Bird Lake">Lady Bird Lake</div>
                                <div class="sim-list-item" data-city="Austin" data-value="Zilker Park">Zilker Park</div>
                            </div>
                        </div>
                        <div class="sim-display" id="dynamicDisplay">Selected: Pike Place Market</div>
                        <button class="sim-button" onclick="addDynamicCity()">Add City</button>
                        <button class="sim-button" onclick="deleteDynamicAttraction()">Delete Selected</button>
                    </div>
                    <!-- Page 10: LMS Features -->
                    <div class="sim-demo hidden" id="sim3">
                        <h4 style="color: #4ECDC4; text-align: center;">LMS Features</h4>
                        <div class="sim-display">
                            <p>Quiz Management</p>
                            <p>Analytics Dashboard</p>
                            <p>Student Progress Tracking</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="navigation">
            <button class="nav-btn" id="prevBtn" onclick="prevPage()" disabled aria-label="Go to previous page">Previous</button>
            <div style="display: flex; gap: 10px;">
                <span style="color: #666;">Page Navigation:</span>
                <span id="pageIndicator">1 of 10</span>
            </div>
            <button class="nav-btn" id="nextBtn" onclick="nextPage()" aria-label="Go to next page">Next</button>
        </div>
    </div>

    <script>
/* --------------------------------------------------------
   Pager Logic (fixed)
---------------------------------------------------------*/
(function () {
  const $ = (sel) => document.querySelector(sel);
  let currentPageNum = 1;
  const pages = Array.from({ length: 10 }, (_, i) => "page" + (i + 1));
  const sims = ["sim1", "sim2", "sim3"];

  const updateSim = (pageNum) => {
    sims.forEach((id) => $( "#" + id )?.classList.add("hidden"));
    if (pageNum <= 8) {
      $("#sim1")?.classList.remove("hidden");
    } else if (pageNum === 9) {
      $("#sim2")?.classList.remove("hidden");
    } else if (pageNum === 10) {
      $("#sim3")?.classList.remove("hidden");
    }
  };

  function setActive(pageId) {
    const pageNum = Number(pageId.replace("page", "")) || 1;
    currentPageNum = pageNum;

    pages.forEach((id) => document.getElementById(id)?.classList.remove("active"));
    document.getElementById(pageId)?.classList.add("active");

    const cp = $("#currentPage");
    if (cp) cp.textContent = String(pageNum);
    const pi = $("#pageIndicator");
    if (pi) pi.textContent = `${pageNum} of ${pages.length}`;
    const prev = $("#prevBtn");
    if (prev) prev.disabled = pageNum === 1;
    const next = $("#nextBtn");
    if (next) next.disabled = pageNum === pages.length;

    updateSim(pageNum);
    location.hash = pageId;
  }

  window.nextPage = () => {
    if (currentPageNum < pages.length) setActive("page" + (currentPageNum + 1));
  };
  window.prevPage = () => {
    if (currentPageNum > 1) setActive("page" + (currentPageNum - 1));
  };

  const boot = () => {
    const fromHash = (location.hash || "").replace("#", "");
    if (fromHash && document.getElementById(fromHash)) {
      setActive(fromHash);
    } else {
      setActive("page1");
    }
  };
  if (document.readyState === "loading") {
    document.addEventListener("DOMContentLoaded", boot);
  } else {
    boot();
  }
})();

/* --------------------------------------------------------
   Simulator Functions
---------------------------------------------------------*/
let selectedAttraction = { city: "Seattle", name: "Pike Place Market" };
let dynamicCities = [
  { name: "Seattle", attractions: ["Pike Place Market", "Space Needle"] },
  { name: "Austin", attractions: ["Lady Bird Lake", "Zilker Park"] }
];
let dynamicSelectedAttraction = { city: "Seattle", name: "Pike Place Market" };

function updateSectionList() {
  const items = document.querySelectorAll('#sectionList .sim-list-item');
  items.forEach(item => {
    item.classList.remove('selected');
    if (item.getAttribute('data-city') === selectedAttraction.city &&
        item.getAttribute('data-value') === selectedAttraction.name) {
      item.classList.add('selected');
    }
    item.onclick = () => {
      selectedAttraction = {
        city: item.getAttribute('data-city'),
        name: item.getAttribute('data-value')
      };
      updateSectionList();
    };
  });
  document.getElementById('listDisplay').textContent = `Selected: ${selectedAttraction.name}`;
}

function addAttraction() {
  const list = document.getElementById('sectionList');
  const newAttraction = `New Attraction ${document.querySelectorAll('#sectionList .sim-list-item').length + 1}`;
  const newItem = document.createElement('div');
  newItem.className = 'sim-list-item';
  newItem.setAttribute('data-city', 'Seattle');
  newItem.setAttribute('data-value', newAttraction);
  newItem.textContent = newAttraction;
  newItem.onclick = () => {
    selectedAttraction = { city: 'Seattle', name: newAttraction };
    updateSectionList();
  };
  const seattleSection = Array.from(list.children).find(el => el.classList.contains('sim-section-header') && el.textContent === 'Seattle');
  const nextSection = Array.from(list.children).find((el, index) => index > Array.from(list.children).indexOf(seattleSection) && el.classList.contains('sim-section-header'));
  list.insertBefore(newItem, nextSection || null);
  updateSectionList();
}

function deleteAttraction() {
  const items = document.querySelectorAll('#sectionList .sim-list-item');
  items.forEach(item => {
    if (item.getAttribute('data-city') === selectedAttraction.city &&
        item.getAttribute('data-value') === selectedAttraction.name) {
      item.remove();
    }
  });
  const firstInCity = Array.from(document.querySelectorAll('#sectionList .sim-list-item')).find(item => item.getAttribute('data-city') === selectedAttraction.city);
  selectedAttraction = firstInCity
      ? { city: firstInCity.getAttribute('data-city'), name: firstInCity.getAttribute('data-value') }
      : { city: 'Seattle', name: 'Pike Place Market' };
  updateSectionList();
}

function updateDynamicSectionList() {
  const list = document.getElementById('dynamicSectionList');
  list.innerHTML = '';
  dynamicCities.forEach(city => {
    const header = document.createElement('div');
    header.className = 'sim-section-header';
    header.textContent = city.name;
    list.appendChild(header);
    city.attractions.forEach(attraction => {
      const item = document.createElement('div');
      item.className = 'sim-list-item';
      item.setAttribute('data-city', city.name);
      item.setAttribute('data-value', attraction);
      item.textContent = attraction;
      if (city.name === dynamicSelectedAttraction.city && attraction === dynamicSelectedAttraction.name) {
        item.classList.add('selected');
      }
      item.onclick = () => {
        dynamicSelectedAttraction = { city: city.name, name: attraction };
        updateDynamicSectionList();
      };
      list.appendChild(item);
    });
  });
  document.getElementById('dynamicDisplay').textContent = `Selected: ${dynamicSelectedAttraction.name}`;
}

function addDynamicCity() {
  dynamicCities.push({ name: `New City ${dynamicCities.length + 1}`, attractions: [] });
  updateDynamicSectionList();
}

function deleteDynamicAttraction() {
  dynamicCities = dynamicCities.map(city => {
    if (city.name === dynamicSelectedAttraction.city) {
      return { name: city.name, attractions: city.attractions.filter(attr => attr !== dynamicSelectedAttraction.name) };
    }
    return city;
  }).filter(city => city.attractions.length > 0 || city.name === dynamicSelectedAttraction.city);
  dynamicSelectedAttraction = dynamicCities[0]?.attractions[0]
    ? { city: dynamicCities[0].name, name: dynamicCities[0].attractions[0] }
    : { city: '', name: '' };
  updateDynamicSectionList();
}

/* --------------------------------------------------------
   LMS Functions with Canvas Visualization
---------------------------------------------------------*/
let quizSettings = {
  title: "SwiftUI Lists and Sections Quiz",
  startDate: new Date("2025-08-19T09:00:00"),
  endDate: new Date("2025-08-20T23:59:59"),
  duration: 20,
  accessPassword: "student123",
  instructorCode: "instructor456",
  maxAttempts: 3
};

let quizData = { attempts: 0, scores: [], questionPerformance: { q1: 0, q2: 0, q3: 0 }, studentData: [] };

function updateLMSDate() {
  const lmsDate = document.getElementById('lmsDate');
  lmsDate.textContent = new Date().toLocaleString();
}

function toggleSettings() {
  const settingsPanel = document.getElementById('settingsPanel');
  settingsPanel.classList.toggle('hidden');
}

function selectStudentRole() {
  document.getElementById('roleSelection').classList.add('hidden');
  document.getElementById('lmsContainer').classList.remove('hidden');
  document.getElementById('studentPanel').classList.remove('hidden');
  document.getElementById('facultyPanel').classList.add('hidden');
}

function selectInstructorRole() {
  const password = prompt("Enter Instructor Password:");
  if (password === quizSettings.instructorCode) {
    document.getElementById('roleSelection').classList.add('hidden');
    document.getElementById('lmsContainer').classList.remove('hidden');
    document.getElementById('facultyPanel').classList.remove('hidden');
    document.getElementById('studentPanel').classList.add('hidden');
    updateAnalytics();
  } else {
    alert("Incorrect instructor password.");
  }
}

/* --------------------------------------------------------
   Finish LMS + Utilities
---------------------------------------------------------*/
function fmtDate(dt) { try { return new Date(dt).toLocaleString(); } catch { return String(dt); } }
function getEl(id) { return document.getElementById(id); }

function drawQuestionChart() {
  const canvas = getEl('questionChart'); if (!canvas) return;
  const ctx = canvas.getContext('2d');
  const attempts = Math.max(quizData.attempts, 1);
  const qKeys = ['q1','q2','q3'];
  const labels = ['Q1','Q2','Q3'];
  const values = qKeys.map(k => Math.round((quizData.questionPerformance[k] / attempts) * 100));

  ctx.clearRect(0, 0, canvas.width, canvas.height);
  const padding = 28, W = canvas.width, H = canvas.height;
  const chartW = W - padding*2, chartH = H - padding*2;
  const barW = Math.floor(chartW / (values.length * 2));
  const baseX = padding, baseY = H - padding;

  ctx.lineWidth = 1; ctx.beginPath(); ctx.moveTo(padding, padding); ctx.lineTo(padding, baseY); ctx.lineTo(W - padding, baseY); ctx.stroke();
  ctx.font = '12px system-ui, -apple-system, Segoe UI, sans-serif';
  [0,50,100].forEach(p => {
    const y = baseY - (p/100)*chartH; ctx.fillText(`${p}%`, 2, y + 4);
    ctx.globalAlpha = 0.15; ctx.beginPath(); ctx.moveTo(padding, y); ctx.lineTo(W - padding, y); ctx.stroke(); ctx.globalAlpha = 1;
  });

  values.forEach((v, i) => {
    const x = baseX + i * (barW * 2.2) + barW * 0.5;
    const h = (v/100) * chartH;
    const y = baseY - h;
    ctx.beginPath(); ctx.rect(x, y, barW, h); ctx.fill();
    ctx.fillText(labels[i], x + barW/2 - 8, baseY + 16);
    ctx.fillText(`${v}%`, x + barW/2 - 12, y - 6);
  });

  const qs = getEl('questionStats');
  if (qs) {
    qs.innerHTML = `
      <p>Q1 - Section Basics: ${values[0]}% correct</p>
      <p>Q2 - Data Source: ${values[1]}% correct</p>
      <p>Q3 - Filtering: ${values[2]}% correct</p>
    `;
  }
}

function updateAnalytics() {
  getEl('attemptCount').textContent = String(quizData.attempts);
  const total = quizData.scores.reduce((a,b) => a + b, 0);
  const avgPct = quizData.scores.length ? Math.round((total / (quizData.scores.length * 3)) * 100) : 0;
  getEl('averageScore').textContent = `${avgPct}%`;
  const uniqueStudents = new Set(quizData.studentData.map(s => s.name)).size;
  const completionRate = uniqueStudents ? 100 : 0;
  getEl('completionRate').textContent = `${completionRate}%`;
  getEl('progressFill').style.width = `${avgPct}%`;

  const ss = getEl('studentStats');
  if (ss) {
    ss.innerHTML = quizData.studentData.length
      ? quizData.studentData.map(s => `<p>${s.name} — attempts: ${s.attempts}, best: ${Math.round((s.bestScore/3)*100)}%</p>`).join('')
      : `<p>No student data available.</p>`;
  }
  drawQuestionChart();
}

function updateQuizStatusUI() {
  const now = new Date();
  const quizStatus = getEl('quizStatus'); if (!quizStatus) return;
  quizStatus.classList.remove('status-pending','status-active','status-ended');

  if (now < quizSettings.startDate) {
    quizStatus.textContent = `Quiz will be available on ${fmtDate(quizSettings.startDate)}`;
    quizStatus.classList.add('status-pending');
  } else if (now > quizSettings.endDate) {
    quizStatus.textContent = `Quiz ended on ${fmtDate(quizSettings.endDate)}`;
    quizStatus.classList.add('status-ended');
  } else {
    quizStatus.textContent = `Quiz is active until ${fmtDate(quizSettings.endDate)}`;
    quizStatus.classList.add('status-active');
  }
}

function saveAssessmentSettings() {
  const title = getEl('quizTitle')?.value?.trim() || quizSettings.title;
  const start = new Date(getEl('startDate').value || quizSettings.startDate);
  const end = new Date(getEl('endDate').value || quizSettings.endDate);
  const duration = Math.max(5, parseInt(getEl('duration').value || quizSettings.duration, 10));
  const accessPwd = getEl('accessPassword').value || quizSettings.accessPassword;
  const instrPwd = getEl('instructorCode').value || quizSettings.instructorCode;
  const maxAttemptsSel = getEl('maxAttempts').value;

  if (isNaN(start.getTime()) || isNaN(end.getTime()) || start >= end) { alert('Please provide valid Start/End dates (Start must be before End).'); return; }

  quizSettings.title = title;
  quizSettings.startDate = start;
  quizSettings.endDate = end;
  quizSettings.duration = duration;
  quizSettings.accessPassword = accessPwd;
  quizSettings.instructorCode = instrPwd;
  quizSettings.maxAttempts = (maxAttemptsSel === 'unlimited') ? 'unlimited' : parseInt(maxAttemptsSel, 10);

  updateQuizStatusUI(); updateAnalytics(); alert('Settings saved.');
}

let timerInterval = null;
let activeStudent = null;
let secondsRemaining = 0;

function canAttemptMore(student) {
  if (quizSettings.maxAttempts === 'unlimited') return true;
  return student.attempts < (quizSettings.maxAttempts || 1);
}

function findOrCreateStudent(name) {
  let s = quizData.studentData.find(x => x.name.toLowerCase() === name.toLowerCase());
  if (!s) { s = { name, attempts: 0, bestScore: 0 }; quizData.studentData.push(s); }
  return s;
}

function clearQuizInputs() {
  ['q1','q2','q3'].forEach(q => { const checked = document.querySelector(`input[name="${q}"]:checked`); if (checked) checked.checked = false; });
}

function startTimer() {
  secondsRemaining = (quizSettings.duration || 20) * 60;
  const timerEl = getEl('timer');
  if (timerInterval) clearInterval(timerInterval);
  const tick = () => {
    const mm = String(Math.floor(secondsRemaining / 60)).padStart(2,'0');
    const ss = String(secondsRemaining % 60).padStart(2,'0');
    timerEl.textContent = `${mm}:${ss}`;
    if (secondsRemaining <= 0) { clearInterval(timerInterval); timerInterval = null; submitAssessment(true); }
    secondsRemaining--;
  };
  tick(); timerInterval = setInterval(tick, 1000);
}

function startAssessment() {
  const name = (getEl('studentName').value || '').trim();
  const pwd  = (getEl('studentPassword').value || '').trim();

  if (!name) { alert('Please enter your name.'); return; }
  if (pwd !== quizSettings.accessPassword) { alert('Incorrect quiz password.'); return; }

  const now = new Date();
  if (now < quizSettings.startDate) { alert(`Quiz not open yet. Opens: ${fmtDate(quizSettings.startDate)}`); return; }
  if (now > quizSettings.endDate)   { alert(`Quiz already ended on: ${fmtDate(quizSettings.endDate)}`); return; }

  const s = findOrCreateStudent(name);
  if (!canAttemptMore(s)) { alert('No attempts remaining.'); return; }
  activeStudent = s;

  getEl('loginSection').classList.add('hidden');
  getEl('quizSection').classList.remove('hidden');
  getEl('resultsSection').classList.add('hidden');
  updateQuizStatusUI(); clearQuizInputs(); startTimer();
}

function submitAssessment(auto = false) {
  if (timerInterval) { clearInterval(timerInterval); timerInterval = null; }

  const answers = { q1: 'b', q2: 'b', q3: 'b' };
  const chosen = {};
  ['q1','q2','q3'].forEach(q => { const chk = document.querySelector(`input[name="${q}"]:checked`); chosen[q] = chk ? chk.value : null; });

  let score = 0;
  const details = [];
  const recommendations = [];

  Object.keys(answers).forEach((q, idx) => {
    const isCorrect = chosen[q] === answers[q];
    if (isCorrect) { score++; quizData.questionPerformance[q] += 1; }
    else {
      if (q === 'q1') recommendations.push('Review Section basics and list grouping.');
      if (q === 'q2') recommendations.push('Practice @EnvironmentObject for shared state.');
      if (q === 'q3') recommendations.push('Revisit filtering with computed data and search.');
    }
    details.push(`Q${idx+1}: ${isCorrect ? '✓ Correct' : '✗ Incorrect'}`);
  });

  quizData.attempts += 1; quizData.scores.push(score);
  if (activeStudent) { activeStudent.attempts += 1; activeStudent.bestScore = Math.max(activeStudent.bestScore, score); }

  getEl('quizSection').classList.add('hidden');
  getEl('resultsSection').classList.remove('hidden');

  const pct = Math.round((score/3)*100);
  getEl('scoreDisplay').textContent = `Your Score: ${score}/3 (${pct}%)`;
  getEl('detailedResults').innerHTML = details.map(d => `<p>${d}</p>`).join('');
  getEl('studyRecommendations').innerHTML = (recommendations.length
    ? recommendations.map(r => `<li>${r}</li>`).join('')
    : '<li>Great job! Review styling modifiers for mastery.</li>');

  const retakeBtn = getEl('retakeBtn');
  const canRetake = activeStudent && canAttemptMore(activeStudent);
  retakeBtn.disabled = !canRetake;
  retakeBtn.textContent = canRetake ? 'Retake Quiz' : 'No Attempts Left';

  updateAnalytics();
}

function retakeAssessment() {
  if (!activeStudent) { alert('No active student.'); return; }
  if (!canAttemptMore(activeStudent)) { alert('No attempts remaining.'); return; }
  getEl('resultsSection').classList.add('hidden');
  getEl('quizSection').classList.remove('hidden');
  clearQuizInputs(); startTimer();
}

// update clock
setInterval(updateLMSDate, 30000);

/* --------------------------------------------------------
   Download Buttons: provide .swift snippets
---------------------------------------------------------*/
function downloadText(filename, content) {
  const blob = new Blob([content], { type: 'text/plain' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a'); a.href = url; a.download = filename;
  document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
}

function downloadDynamicSectionCode() {
  const code = `import SwiftUI

struct Attraction: Identifiable { let id = UUID(); var name: String }
struct City: Identifiable { let id = UUID(); var name: String; var attractions: [Attraction] }

struct DynamicSectionListView: View {
    @State private var cities = [
        City(name: "Seattle", attractions: [Attraction(name: "Pike Place Market"), Attraction(name: "Space Needle")]),
        City(name: "Austin", attractions: [Attraction(name: "Lady Bird Lake"), Attraction(name: "Zilker Park")])
    ]

    var body: some View {
        NavigationView {
            List {
                ForEach(cities) { city in
                    Section(header: Text(city.name)) {
                        ForEach(city.attractions) { attraction in
                            NavigationLink(destination: Text("Details for \\(attraction.name)")) {
                                Text(attraction.name)
                            }
                        }
                        .onDelete { offsets in deleteAttraction(in: city, at: offsets) }
                    }
                }
            }
            .navigationTitle("City Guide")
            .listStyle(.insetGrouped)
            .toolbar { ToolbarItem { Button("Add City", action: addCity) } }
        }
    }

    private func addCity() { cities.append(City(name: "New City", attractions: [])) }

    private func deleteAttraction(in city: City, at offsets: IndexSet) {
        if let index = cities.firstIndex(where: { $0.id == city.id }) {
            cities[index].attractions.remove(atOffsets: offsets)
        }
    }
}`;
  downloadText('DynamicSectionListView.swift', code);
}

function downloadCityGuideSectionCode() {
  const code = `import SwiftUI

struct CityGuideSectionListView: View {
    @State private var cities = [
        City(name: "Seattle", attractions: [Attraction(name: "Pike Place Market"), Attraction(name: "Space Needle")]),
        City(name: "Austin", attractions: [Attraction(name: "Lady Bird Lake"), Attraction(name: "Zilker Park")])
    ]

    var body: some View {
        NavigationView {
            List {
                ForEach(cities) { city in
                    Section(header: Text(city.name).font(.title2)) {
                        ForEach(city.attractions) { attraction in
                            NavigationLink(destination: Text("Explore \\(attraction.name)")) {
                                Text(attraction.name)
                            }
                        }
                    }
                }
            }
            .navigationTitle("City Guide")
            .listStyle(.insetGrouped)
        }
    }
}

struct City: Identifiable { let id = UUID(); var name: String; var attractions: [Attraction] }
struct Attraction: Identifiable { let id = UUID(); var name: String }`;
  downloadText('CityGuideSectionListView.swift', code);
}

function downloadSimulatorSectionCode() {
  const code = `import SwiftUI

struct SimulatorSectionListView: View {
    @State private var cities = [
        City(name: "Seattle", attractions: [Attraction(name: "Pike Place Market"), Attraction(name: "Space Needle")]),
        City(name: "Austin", attractions: [Attraction(name: "Lady Bird Lake"), Attraction(name: "Zilker Park")])
    ]

    var body: some View {
        NavigationView {
            List {
                ForEach(cities) { city in
                    Section(header: Text(city.name)) {
                        ForEach(city.attractions) { attraction in
                            NavigationLink(destination: Text("Explore \\(attraction.name)")) {
                                Text(attraction.name)
                            }
                        }
                        .onDelete { offsets in deleteAttraction(in: city, at: offsets) }
                    }
                }
            }
            .navigationTitle("City Guide")
            .listStyle(.insetGrouped)
            .toolbar { ToolbarItem { Button("Add City", action: addCity) } }
        }
    }

    private func addCity() { cities.append(City(name: "New City", attractions: [])) }

    private func deleteAttraction(in city: City, at offsets: IndexSet) {
        if let index = cities.firstIndex(where: { $0.id == city.id }) {
            cities[index].attractions.remove(atOffsets: offsets)
        }
    }
}

struct City: Identifiable { let id = UUID(); var name: String; var attractions: [Attraction] }
struct Attraction: Identifiable { let id = UUID(); var name: String }`;
  downloadText('SimulatorSectionListView.swift', code);
}

/* --------------------------------------------------------
   Bootstrapping (wire simulators, LMS clock & analytics)
---------------------------------------------------------*/
document.addEventListener('DOMContentLoaded', () => {
  try { updateSectionList(); } catch {}
  try { updateDynamicSectionList(); } catch {}

  updateLMSDate();

  const s = quizSettings;
  if (getEl('quizTitle')) getEl('quizTitle').value = s.title;
  if (getEl('startDate')) getEl('startDate').value = new Date(s.startDate.getTime() - (new Date().getTimezoneOffset()*60000)).toISOString().slice(0,16);
  if (getEl('endDate'))   getEl('endDate').value   = new Date(s.endDate.getTime()   - (new Date().getTimezoneOffset()*60000)).toISOString().slice(0,16);
  if (getEl('duration'))  getEl('duration').value  = s.duration;
  if (getEl('accessPassword'))  getEl('accessPassword').value  = s.accessPassword;
  if (getEl('instructorCode'))  getEl('instructorCode').value  = s.instructorCode;
  if (getEl('maxAttempts'))     getEl('maxAttempts').value     = (s.maxAttempts === 'unlimited') ? 'unlimited' : String(s.maxAttempts);

  updateQuizStatusUI();
  updateAnalytics();
});

setInterval(updateQuizStatusUI, 15000);
    </script>
</body>
</html>
