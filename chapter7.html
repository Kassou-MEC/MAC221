<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SwiftUI Chapter 7: State and Interactivity</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .presentation-container {
            width: 95%;
            max-width: 1200px;
            height: 90vh;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .header {
            background: linear-gradient(90deg, #FF6B6B, #4ECDC4);
            color: white;
            padding: 20px;
            text-align: center;
            position: relative;
        }

        .page-counter {
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255,255,255,0.2);
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: bold;
        }

        .content-area {
            flex: 1;
            display: flex;
            overflow: hidden;
        }

        .main-content {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
        }

        .simulator {
            width: 350px;
            background: #f8f9fa;
            border-left: 2px solid #e9ecef;
            padding: 20px;
            overflow-y: auto;
        }

        .page {
            display: none;
            animation: slideIn 0.5s ease-out;
        }

        .page.active {
            display: block;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            background: #f8f9fa;
            border-top: 1px solid #e9ecef;
        }

        .nav-btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .nav-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .nav-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .code-block {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 14px;
            line-height: 1.5;
            overflow-x: auto;
        }

        .definition-box {
            background: linear-gradient(135deg, #ffeef7, #e8f4ff);
            border-left: 4px solid #FF6B6B;
            padding: 20px;
            margin: 15px 0;
            border-radius: 8px;
        }

        .definition-box h3 {
            color: #FF6B6B;
            margin-bottom: 10px;
        }

        .simulator-phone {
            background: #000;
            border-radius: 30px;
            padding: 20px;
            margin: 20px 0;
            color: white;
            min-height: 400px;
        }

        .practice-exercise {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
        }

        .exercise-title {
            color: #d63031;
            font-weight: bold;
            margin-bottom: 10px;
        }

        /* Simulator Components */
        .sim-button {
            background: #007AFF;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            margin: 10px 5px;
            cursor: pointer;
            font-size: 16px;
        }

        .sim-textfield {
            width: 100%;
            padding: 12px;
            border: 1px solid #ccc;
            border-radius: 8px;
            margin: 10px 0;
            font-size: 16px;
        }

        .sim-counter {
            font-size: 24px;
            text-align: center;
            margin: 20px 0;
            color: #007AFF;
            font-weight: bold;
        }

        /* Learning Management System Styles */
        .lms-header {
            background-color: #2d3748;
            color: white;
            padding: 10px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-top-left-radius: 10px;
            border-top-right-radius: 10px;
        }

        .lms-title {
            display: flex;
            align-items: center;
        }

        .lms-icon {
            margin-right: 10px;
        }

        .lms-date {
            font-size: 0.8em;
            opacity: 0.8;
        }

        .lms-gear {
            cursor: pointer;
        }

        .role-selection {
            text-align: center;
            padding: 50px 0;
        }

        .role-title {
            font-size: 2em;
            color: #2d3748;
            margin-bottom: 10px;
        }

        .role-subtitle {
            color: #4a5568;
            margin-bottom: 40px;
        }

        .role-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
        }

        .student-btn {
            background-color: #48bb78;
            color: white;
            padding: 15px 30px;
            border-radius: 30px;
            font-size: 1.2em;
            cursor: pointer;
            display: flex;
            align-items: center;
            text-align: center;
        }

        .instructor-btn {
            background-color: #4299e1;
            color: white;
            padding: 15px 30px;
            border-radius: 30px;
            font-size: 1.2em;
            cursor: pointer;
            display: flex;
            align-items: center;
            text-align: center;
        }

        .btn-icon {
            margin-right: 10px;
        }

        .lms-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            height: 100%;
        }

        .faculty-panel, .student-panel {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .faculty-panel {
            background: linear-gradient(135deg, #ff9a9e, #fecfef);
        }

        .student-panel {
            background: linear-gradient(135deg, #a8edea, #fed6e3);
        }

        .hidden {
            display: none !important;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #333;
        }

        .form-group input, .form-group select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }

        .quiz-status {
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            text-align: center;
            font-weight: bold;
        }

        .status-pending {
            background: #ffeaa7;
            color: #d63031;
        }

        .status-active {
            background: #00b894;
            color: white;
        }

        .status-ended {
            background: #e17055;
            color: white;
        }

        .timer {
            font-size: 24px;
            text-align: center;
            color: #d63031;
            font-weight: bold;
            margin: 20px 0;
        }

        .quiz-content {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
        }

        .question {
            margin-bottom: 20px;
        }

        .question h4 {
            margin-bottom: 10px;
            color: #333;
        }

        .options {
            list-style: none;
        }

        .options li {
            margin: 8px 0;
        }

        .options input[type="radio"] {
            margin-right: 10px;
        }

        .submit-btn {
            background: #00b894;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            width: 100%;
            margin-top: 20px;
        }

        .analytics {
            background: white;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
        }

        .analytics h4 {
            color: #333;
            margin-bottom: 10px;
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: #e9ecef;
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #00b894, #00cec9);
            transition: width 0.3s ease;
        }
    </style>
</head>
<body>
    <div class="presentation-container">
        <div class="header">
            <h1>SwiftUI Chapter 7: State and Interactivity</h1>
            <div class="page-counter">
                <span id="currentPage">1</span> / 11
            </div>
        </div>

        <div class="content-area">
            <div class="main-content">
                <!-- Page 1: Introduction -->
                <div class="page active" id="page1">
                    <h2>Welcome to SwiftUI State and Interactivity!</h2>
                    
                    <div class="definition-box">
                        <h3>What is State in SwiftUI?</h3>
                        <p><strong>State</strong> is a property wrapper that allows SwiftUI views to store and modify data. When state changes, SwiftUI automatically updates the user interface to reflect those changes.</p>
                    </div>

                    <h3>What You'll Learn Today:</h3>
                    <ul style="margin: 20px 0; padding-left: 30px; line-height: 2;">
                        <li>Understanding the @State property wrapper</li>
                        <li>Creating interactive buttons</li>
                        <li>Handling user input with TextField</li>
                        <li>Data binding between views</li>
                        <li>Building practical interactive apps</li>
                        <li>Creating a complete learning management system</li>
                    </ul>

                    <div style="background: #e8f4ff; padding: 20px; border-radius: 10px; margin-top: 30px;">
                        <h4 style="color: #0066cc;">üí° Key Concept</h4>
                        <p>SwiftUI uses a <strong>declarative</strong> approach - you describe what you want the UI to look like, and SwiftUI handles the updates automatically when data changes.</p>
                    </div>
                </div>

                <!-- Page 2: @State Basics -->
                <div class="page" id="page2">
                    <h2>Understanding @State Property Wrapper</h2>
                    
                    <div class="definition-box">
                        <h3>@State Definition</h3>
                        <p>@State is a property wrapper that tells SwiftUI to monitor this property for changes. When the value changes, any view using this property will automatically re-render.</p>
                    </div>

                    <h3>Basic @State Syntax:</h3>
                    <div class="code-block">
struct ContentView: View {
    @State private var counter = 0
    
    var body: some View {
        Text("Count: \(counter)")
    }
}</div>

                    <h3>Key Rules for @State:</h3>
                    <ul style="margin: 20px 0; padding-left: 30px; line-height: 2;">
                        <li><strong>Always use 'private'</strong> - State should only be accessed by the view that owns it</li>
                        <li><strong>Initialize with a default value</strong> - Give your state variable a starting value</li>
                        <li><strong>Use for simple value types</strong> - Best for Int, String, Bool, etc.</li>
                        <li><strong>Declare inside the struct</strong> - @State properties belong to the view</li>
                    </ul>

                    <div class="practice-exercise">
                        <div class="exercise-title">üèãÔ∏è Practice Exercise</div>
                        <p>Try creating a @State variable for a person's name. Initialize it with "John Doe" and display it in a Text view.</p>
                    </div>
                </div>

                <!-- Page 3: Button Interactions -->
                <div class="page" id="page3">
                    <h2>Buttons and User Interactions</h2>
                    
                    <div class="definition-box">
                        <h3>Button in SwiftUI</h3>
                        <p>A <strong>Button</strong> is a control that performs an action when tapped. It consists of a label (what the user sees) and an action (what happens when tapped).</p>
                    </div>

                    <h3>Basic Button Syntax:</h3>
                    <div class="code-block">
Button("Tap Me!") {
    // Action code goes here
    print("Button was tapped!")
}</div>

                    <h3>Button with @State - Interactive Counter:</h3>
                    <div class="code-block">
struct CounterView: View {
    @State private var count = 0
    
    var body: some View {
        VStack {
            Text("Count: \(count)")
                .font(.largeTitle)
            
            Button("Add 1") {
                count += 1
            }
            .buttonStyle(.borderedProminent)
        }
    }
}</div>

                    <h3>Button Styling Options:</h3>
                    <ul style="margin: 20px 0; padding-left: 30px; line-height: 2;">
                        <li><code>.buttonStyle(.plain)</code> - No special styling</li>
                        <li><code>.buttonStyle(.bordered)</code> - Outlined button</li>
                        <li><code>.buttonStyle(.borderedProminent)</code> - Filled button</li>
                        <li><code>.foregroundColor(.red)</code> - Custom text color</li>
                    </ul>
                </div>

                <!-- Page 4: Advanced Button Interactions -->
                <div class="page" id="page4">
                    <h2>Advanced Button Interactions</h2>
                    
                    <h3>Multiple Buttons Working Together:</h3>
                    <div class="code-block">
struct AdvancedCounterView: View {
    @State private var count = 0
    
    var body: some View {
        VStack(spacing: 20) {
            Text("Count: \(count)")
                .font(.largeTitle)
                .foregroundColor(count > 0 ? .green : .red)
            
            HStack {
                Button("Subtract") {
                    count -= 1
                }
                .buttonStyle(.bordered)
                
                Button("Reset") {
                    count = 0
                }
                .buttonStyle(.borderedProminent)
                
                Button("Add") {
                    count += 1
                }
                .buttonStyle(.bordered)
            }
        }
        .padding()
    }
}</div>

                    <h3>Button with Custom Styling:</h3>
                    <div class="code-block">
Button("Custom Button") {
    // Action
}
.frame(width: 200, height: 50)
.background(Color.blue)
.foregroundColor(.white)
.cornerRadius(25)
.shadow(radius: 5)</div>

                    <div class="practice-exercise">
                        <div class="exercise-title">üéØ Challenge Exercise</div>
                        <p>Create a button that changes its own text each time it's tapped. Start with "Tap Me" and cycle through "Tapped!", "Again!", "More!", then back to "Tap Me".</p>
                    </div>
                </div>

                <!-- Page 5: TextField and User Input -->
                <div class="page" id="page5">
                    <h2>TextField and User Input</h2>
                    
                    <div class="definition-box">
                        <h3>TextField Definition</h3>
                        <p><strong>TextField</strong> allows users to enter and edit text. It requires a binding to a @State variable to store the user's input.</p>
                    </div>

                    <h3>Basic TextField Syntax:</h3>
                    <div class="code-block">
struct TextInputView: View {
    @State private var userName = ""
    
    var body: some View {
        VStack {
            TextField("Enter your name", text: $userName)
                .textFieldStyle(.roundedBorder)
                .padding()
            
            Text("Hello, \(userName)!")
                .font(.headline)
        }
    }
}</div>

                    <h3>Important TextField Concepts:</h3>
                    <ul style="margin: 20px 0; padding-left: 30px; line-height: 2;">
                        <li><strong>$ (Dollar Sign)</strong> - Creates a binding to the @State variable</li>
                        <li><strong>Placeholder Text</strong> - The hint text shown when field is empty</li>
                        <li><strong>.textFieldStyle()</strong> - Applies visual styling to the field</li>
                        <li><strong>Real-time Updates</strong> - Text updates as the user types</li>
                    </ul>

                    <h3>TextField Styling Options:</h3>
                    <div class="code-block">
TextField("Search", text: $searchText)
    .textFieldStyle(.roundedBorder)
    .padding()
    .background(Color.gray.opacity(0.1))
    .cornerRadius(10)</div>
                </div>

                <!-- Page 6: Advanced TextField Features -->
                <div class="page" id="page6">
                    <h2>Advanced TextField Features</h2>
                    
                    <h3>Different Types of Text Input:</h3>
                    <div class="code-block">
struct AdvancedTextInputView: View {
    @State private var email = ""
    @State private var password = ""
    @State private var age = ""
    
    var body: some View {
        VStack(spacing: 15) {
            TextField("Email", text: $email)
                .keyboardType(.emailAddress)
                .autocapitalization(.none)
            
            SecureField("Password", text: $password)
            
            TextField("Age", text: $age)
                .keyboardType(.numberPad)
            
            Button("Submit") {
                print("Email: \(email)")
                print("Age: \(age)")
            }
            .buttonStyle(.borderedProminent)
        }
        .textFieldStyle(.roundedBorder)
        .padding()
    }
}</div>

                    <h3>TextField Modifiers:</h3>
                    <ul style="margin: 20px 0; padding-left: 30px; line-height: 2;">
                        <li><code>.keyboardType(.emailAddress)</code> - Shows email keyboard</li>
                        <li><code>.keyboardType(.numberPad)</code> - Shows number keyboard</li>
                        <li><code>.autocapitalization(.none)</code> - Disables auto-capitalization</li>
                        <li><code>SecureField</code> - For password input (hides text)</li>
                    </ul>

                    <div class="practice-exercise">
                        <div class="exercise-title">üìù Practice Exercise</div>
                        <p>Create a simple calculator that takes two numbers in TextFields and shows their sum when a button is tapped. Use TextField with .keyboardType(.decimalPad).</p>
                    </div>
                </div>

                <!-- Page 7: Data Binding Fundamentals -->
                <div class="page" id="page7">
                    <h2>Understanding Data Binding</h2>
                    
                    <div class="definition-box">
                        <h3>Data Binding Definition</h3>
                        <p><strong>Data Binding</strong> creates a two-way connection between a UI control and a data source. Changes in either direction are automatically synchronized.</p>
                    </div>

                    <h3>The $ Symbol - Creating Bindings:</h3>
                    <div class="code-block">
struct BindingExample: View {
    @State private var isOn = false
    @State private var sliderValue = 50.0
    
    var body: some View {
        VStack {
            Toggle("Power", isOn: $isOn)
            
            Slider(value: $sliderValue, in: 0...100)
            
            Text("Value: \(sliderValue, specifier: "%.0f")")
        }
        .padding()
    }
}</div>

                    <h3>Common Controls Using Binding:</h3>
                    <ul style="margin: 20px 0; padding-left: 30px; line-height: 2;">
                        <li><strong>TextField</strong> - text: $stringVariable</li>
                        <li><strong>Toggle</strong> - isOn: $boolVariable</li>
                        <li><strong>Slider</strong> - value: $doubleVariable</li>
                        <li><strong>Picker</strong> - selection: $selectedValue</li>
                        <li><strong>Stepper</strong> - value: $numberVariable</li>
                    </ul>

                    <h3>Why Use Binding?</h3>
                    <div style="background: #fff3cd; padding: 15px; border-radius: 8px; margin: 20px 0;">
                        <p><strong>Automatic Synchronization:</strong> When the user interacts with a control, the bound variable updates automatically, and any UI that depends on that variable refreshes instantly.</p>
                    </div>
                </div>

                <!-- Page 8: Advanced Data Binding -->
                <div class="page" id="page8">
                    <h2>Advanced Data Binding Patterns</h2>
                    
                    <h3>Binding Between Parent and Child Views:</h3>
                    <div class="code-block">
struct ParentView: View {
    @State private var sharedText = "Hello"
    
    var body: some View {
        VStack {
            Text("Parent: \(sharedText)")
            ChildView(text: $sharedText)
        }
    }
}

struct ChildView: View {
    @Binding var text: String
    
    var body: some View {
        TextField("Enter text", text: $text)
            .textFieldStyle(.roundedBorder)
            .padding()
    }
}</div>

                    <h3>Custom Binding with Computed Properties:</h3>
                    <div class="code-block">
struct TemperatureConverter: View {
    @State private var celsius: Double = 0
    
    private var fahrenheit: Binding&lt;Double&gt; {
        Binding(
            get: { celsius * 9/5 + 32 },
            set: { celsius = ($0 - 32) * 5/9 }
        )
    }
    
    var body: some View {
        VStack {
            TextField("Celsius", value: $celsius, format: .number)
            TextField("Fahrenheit", value: fahrenheit, format: .number)
        }
        .textFieldStyle(.roundedBorder)
        .padding()
    }
}</div>

                    <div class="practice-exercise">
                        <div class="exercise-title">üîó Advanced Challenge</div>
                        <p>Create a view with a Slider that controls the opacity of a Circle. As the user moves the slider, the circle should become more or less transparent.</p>
                    </div>
                </div>

                <!-- Page 9: Practice Exercise 1 -->
                <div class="page" id="page9">
                    <h2>Practice Exercise: Personal Profile Creator</h2>
                    
                    <div class="practice-exercise">
                        <div class="exercise-title">üõ†Ô∏è Build a Personal Profile App</div>
                        <p>Create an app that allows users to create and preview their profile. Include the following features:</p>
                    </div>

                    <h3>Requirements:</h3>
                    <ul style="margin: 20px 0; padding-left: 30px; line-height: 2;">
                        <li>TextField for first name</li>
                        <li>TextField for last name</li>
                        <li>TextField for email</li>
                        <li>Slider for age (16-65)</li>
                        <li>Toggle for newsletter subscription</li>
                        <li>Button to "Save Profile"</li>
                        <li>Live preview of the profile information</li>
                    </ul>

                    <h3>Starter Code:</h3>
                    <div class="code-block">
struct ProfileCreatorView: View {
    @State private var firstName = ""
    @State private var lastName = ""
    @State private var email = ""
    @State private var age: Double = 25
    @State private var subscribeNewsletter = false
    
    var body: some View {
        VStack(spacing: 20) {
            Text("Create Your Profile")
                .font(.largeTitle)
                .bold()
            
            // Add your TextFields, Slider, Toggle here
            
            // Add preview section here
            
            Button("Save Profile") {
                // Handle save action
            }
            .buttonStyle(.borderedProminent)
        }
        .padding()
    }
}</div>

                    <div style="background: #e8f4ff; padding: 15px; border-radius: 8px; margin: 20px 0;">
                        <p><strong>üí° Tip:</strong> Use the simulator on the right to test your implementation!</p>
                    </div>
                </div>

                <!-- Page 10: Practice Exercise 2 -->
                <div class="page" id="page10">
                    <h2>Practice Exercise: Interactive Color Mixer</h2>
                    
                    <div class="practice-exercise">
                        <div class="exercise-title">üé® Build a Color Mixer App</div>
                        <p>Create an app that lets users mix colors using sliders for Red, Green, and Blue values.</p>
                    </div>

                    <h3>Requirements:</h3>
                    <ul style="margin: 20px 0; padding-left: 30px; line-height: 2;">
                        <li>Three sliders for RGB values (0-255)</li>
                        <li>Display current RGB values as text</li>
                        <li>Show a color preview rectangle</li>
                        <li>Button to randomize colors</li>
                        <li>Button to reset to white</li>
                        <li>Display hex color code</li>
                    </ul>

                    <h3>Complete Solution:</h3>
                    <div class="code-block">
struct ColorMixerView: View {
    @State private var redValue: Double = 128
    @State private var greenValue: Double = 128
    @State private var blueValue: Double = 128
    
    private var currentColor: Color {
        Color(red: redValue/255, green: greenValue/255, blue: blueValue/255)
    }
    
    private var hexColor: String {
        String(format: "#%02X%02X%02X", 
               Int(redValue), Int(greenValue), Int(blueValue))
    }
    
    var body: some View {
        VStack(spacing: 20) {
            Text("Color Mixer")
                .font(.largeTitle)
                .bold()
            
            Rectangle()
                .fill(currentColor)
                .frame(height: 150)
                .cornerRadius(15)
            
            Text("RGB: (\(Int(redValue)), \(Int(greenValue)), \(Int(blueValue)))")
            Text("Hex: \(hexColor)")
                .font(.monospaced(.body)())
            
            VStack {
                HStack {
                    Text("Red: \(Int(redValue))")
                    Slider(value: $redValue, in: 0...255)
                }
                HStack {
                    Text("Green: \(Int(greenValue))")
                    Slider(value: $greenValue, in: 0...255)
                }
                HStack {
                    Text("Blue: \(Int(blueValue))")
                    Slider(value: $blueValue, in: 0...255)
                }
            }
            
            HStack {
                Button("Randomize") {
                    redValue = Double.random(in: 0...255)
                    greenValue = Double.random(in: 0...255)
                    blueValue = Double.random(in: 0...255)
                }
                .buttonStyle(.bordered)
                
                Button("Reset") {
                    redValue = 255
                    greenValue = 255
                    blueValue = 255
                }
                .buttonStyle(.borderedProminent)
            }
        }
        .padding()
    }
}</div>
                </div>

                <!-- Page 11: Learning Management System -->
                <div class="page" id="page11">
                    <div class="lms-header">
                        <div class="lms-title">
                            <span class="lms-icon">üìö</span>
                            SwiftUI Learning Management System - Chapter 7 Assessment
                        </div>
                        <div class="lms-date" id="lmsDate"></div>
                        <div class="lms-gear" onclick="toggleSettings()">‚öôÔ∏è</div>
                    </div>

                    <div id="roleSelection">
                        <div class="role-title">Welcome to SwiftUI State Assessment</div>
                        <div class="role-subtitle">Please select your role to continue</div>
                        <div class="role-buttons">
                            <div class="student-btn" onclick="selectStudentRole()">
                                <span class="btn-icon">üéì</span>
                                Student<br>Take Assessment
                            </div>
                            <div class="instructor-btn" onclick="selectInstructorRole()">
                                <span class="btn-icon">üë®‚Äçüè´</span>
                                Instructor<br>View Dashboard
                            </div>
                        </div>
                    </div>

                    <div class="lms-container hidden" id="lmsContainer">
                        <div id="facultyPanel" class="faculty-panel">
                            <h3>Faculty Dashboard</h3>
                            
                            <div id="settingsPanel" class="hidden">
                                <h4>Quiz Settings</h4>
                                
                                <div class="form-group">
                                    <label>Quiz Title:</label>
                                    <input type="text" id="quizTitle" value="SwiftUI State & Interactivity Quiz" placeholder="Enter quiz title">
                                </div>
                                
                                <div class="form-group">
                                    <label>Start Date:</label>
                                    <input type="datetime-local" id="startDate">
                                </div>
                                
                                <div class="form-group">
                                    <label>End Date:</label>
                                    <input type="datetime-local" id="endDate">
                                </div>
                                
                                <div class="form-group">
                                    <label>Duration (minutes):</label>
                                    <input type="number" id="duration" value="30" min="5" max="180">
                                </div>
                                
                                <div class="form-group">
                                    <label>Access Password:</label>
                                    <input type="password" id="accessPassword" placeholder="Set quiz password">
                                </div>
                                
                                <div class="form-group">
                                    <label>Instructor Password:</label>
                                    <input type="password" id="instructorCode" placeholder="Set instructor password">
                                </div>
                                
                                <div class="form-group">
                                    <label>Max Attempts:</label>
                                    <select id="maxAttempts">
                                        <option value="1">1 Attempt</option>
                                        <option value="2">2 Attempts</option>
                                        <option value="3" selected>3 Attempts</option>
                                        <option value="unlimited">Unlimited</option>
                                    </select>
                                </div>
                                
                                <button class="submit-btn" onclick="saveAssessmentSettings()">Save Settings</button>
                            </div>
                            
                            <div class="analytics">
                                <h4>üìä Quiz Analytics</h4>
                                <p>Students Attempted: <span id="attemptCount">0</span></p>
                                <p>Average Score: <span id="averageScore">0%</span></p>
                                <p>Completion Rate: <span id="completionRate">0%</span></p>
                                
                                <div class="progress-bar">
                                    <div class="progress-fill" id="progressFill" style="width: 0%"></div>
                                </div>
                            </div>
                            
                            <div class="analytics">
                                <h4>üéØ Question Performance</h4>
                                <div id="questionStats">
                                    <p>Q1 - @State Basics: 0% correct</p>
                                    <p>Q2 - Button Actions: 0% correct</p>
                                    <p>Q3 - TextField Binding: 0% correct</p>
                                    <p>Q4 - Data Binding: 0% correct</p>
                                </div>
                            </div>
                        </div>
                        
                        <div id="studentPanel" class="student-panel">
                            <h3>Student Portal</h3>
                            
                            <div id="loginSection">
                                <div class="form-group">
                                    <label>Student Name:</label>
                                    <input type="text" id="studentName" placeholder="Enter your name">
                                </div>
                                
                                <div class="form-group">
                                    <label>Quiz Password:</label>
                                    <input type="password" id="studentPassword" placeholder="Enter quiz password">
                                </div>
                                
                                <button class="submit-btn" onclick="startAssessment()">Access Quiz</button>
                            </div>
                            
                            <div id="quizSection" class="hidden">
                                <div id="quizStatus" class="quiz-status status-pending">
                                    Quiz will be available soon
                                </div>
                                
                                <div class="timer" id="timer">30:00</div>
                                
                                <div class="quiz-content">
                                    <div class="question">
                                        <h4>Question 1: What does the @State property wrapper do?</h4>
                                        <ul class="options">
                                            <li><input type="radio" name="q1" value="a"> Creates a constant value</li>
                                            <li><input type="radio" name="q1" value="b"> Monitors property changes and updates UI</li>
                                            <li><input type="radio" name="q1" value="c"> Handles network requests</li>
                                            <li><input type="radio" name="q1" value="d"> Manages app navigation</li>
                                        </ul>
                                    </div>
                                    
                                    <div class="question">
                                        <h4>Question 2: How do you create a binding to a @State variable?</h4>
                                        <ul class="options">
                                            <li><input type="radio" name="q2" value="a"> Using the & symbol</li>
                                            <li><input type="radio" name="q2" value="b"> Using the $ symbol</li>
                                            <li><input type="radio" name="q2" value="c"> Using the * symbol</li>
                                            <li><input type="radio" name="q2" value="d"> Using the # symbol</li>
                                        </ul>
                                    </div>
                                    
                                    <div class="question">
                                        <h4>Question 3: Which modifier makes a TextField show a number keyboard?</h4>
                                        <ul class="options">
                                            <li><input type="radio" name="q3" value="a"> .keyboard(.numbers)</li>
                                            <li><input type="radio" name="q3" value="b"> .inputType(.numeric)</li>
                                            <li><input type="radio" name="q3" value="c"> .keyboardType(.numberPad)</li>
                                            <li><input type="radio" name="q3" value="d"> .numberKeyboard(true)</li>
                                        </ul>
                                    </div>
                                    
                                    <div class="question">
                                        <h4>Question 4: What's the correct syntax for a Button with an action?</h4>
                                        <ul class="options">
                                            <li><input type="radio" name="q4" value="a"> Button { "Click" } action: { }</li>
                                            <li><input type="radio" name="q4" value="b"> Button("Click") { action }</li>
                                            <li><input type="radio" name="q4" value="c"> Button("Click") { /* action */ }</li>
                                            <li><input type="radio" name="q4" value="d"> Button(action: { }) { "Click" }</li>
                                        </ul>
                                    </div>
                                </div>
                                
                                <button class="submit-btn" onclick="submitAssessment()">Submit Quiz</button>
                            </div>
                            
                            <div id="resultsSection" class="hidden">
                                <h4>Quiz Results</h4>
                                <div id="scoreDisplay" class="quiz-status status-active">
                                    Your Score: 0/4 (0%)
                                </div>
                                
                                <div class="analytics">
                                    <h4>üìà Performance Breakdown</h4>
                                    <div id="detailedResults">
                                        <p>Q1: ‚úì Correct</p>
                                        <p>Q2: ‚úó Incorrect</p>
                                        <p>Q3: ‚úì Correct</p>
                                        <p>Q4: ‚úì Correct</p>
                                    </div>
                                    
                                    <div style="margin-top: 15px;">
                                        <p><strong>Recommended Study Areas:</strong></p>
                                        <ul id="studyRecommendations" style="margin-left: 20px;">
                                            <li>Review data binding concepts</li>
                                            <li>Practice with TextField modifiers</li>
                                        </ul>
                                    </div>
                                </div>
                                
                                <button class="submit-btn" onclick="retakeAssessment()" id="retakeBtn">Retake Quiz</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Simulator -->
            <div class="simulator">
                <h3>üì± SwiftUI Simulator</h3>
                <div class="simulator-phone" id="simulatorContent">
                    <!-- Page 1-2: Basic State -->
                    <div class="sim-demo" id="sim1">
                        <h4 style="color: #4ECDC4; text-align: center;">@State Demo</h4>
                        <div class="sim-counter" id="simCounter">Count: 0</div>
                        <button class="sim-button" onclick="incrementCounter()">Add 1</button>
                        <button class="sim-button" onclick="decrementCounter()">Subtract 1</button>
                        <button class="sim-button" onclick="resetCounter()">Reset</button>
                    </div>

                    <!-- Page 3-4: TextField Demo -->
                    <div class="sim-demo" id="sim2" class="hidden">
                        <h4 style="color: #4ECDC4; text-align: center;">TextField Demo</h4>
                        <input class="sim-textfield" id="nameInput" placeholder="Enter your name" oninput="updateGreeting()">
                        <div style="color: #4ECDC4; text-align: center; margin: 20px 0;" id="greeting">Hello, !</div>
                        <button class="sim-button" onclick="clearName()">Clear</button>
                    </div>

                    <!-- Page 5-6: Advanced Demo -->
                    <div class="sim-demo" id="sim3" class="hidden">
                        <h4 style="color: #4ECDC4; text-align: center;">Profile Demo</h4>
                        <input class="sim-textfield" id="firstNameInput" placeholder="First Name" oninput="updateProfile()">
                        <input class="sim-textfield" id="lastNameInput" placeholder="Last Name" oninput="updateProfile()">
                        <div style="color: #4ECDC4; margin: 15px 0; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px;">
                            <div id="profileDisplay">Complete your profile</div>
                        </div>
                    </div>

                    <!-- Page 7-8: Color Mixer -->
                    <div class="sim-demo" id="sim4" class="hidden">
                        <h4 style="color: #4ECDC4; text-align: center;">Color Mixer</h4>
                        <div id="colorPreview" style="width: 100%; height: 80px; border-radius: 10px; background: rgb(128,128,128); margin: 10px 0;"></div>
                        
                        <div style="margin: 10px 0;">
                            <label style="color: #4ECDC4;">Red: <span id="redValue">128</span></label>
                            <input type="range" id="redSlider" min="0" max="255" value="128" style="width: 100%;" oninput="updateColor()">
                        </div>
                        
                        <div style="margin: 10px 0;">
                            <label style="color: #4ECDC4;">Green: <span id="greenValue">128</span></label>
                            <input type="range" id="greenSlider" min="0" max="255" value="128" style="width: 100%;" oninput="updateColor()">
                        </div>
                        
                        <div style="margin: 10px 0;">
                            <label style="color: #4ECDC4;">Blue: <span id="blueValue">128</span></label>
                            <input type="range" id="blueSlider" min="0" max="255" value="128" style="width: 100%;" oninput="updateColor()">
                        </div>
                        
                        <div style="color: #4ECDC4; text-align: center; margin: 10px 0;" id="hexDisplay">#808080</div>
                        
                        <button class="sim-button" onclick="randomizeColor()">Random</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="navigation">
            <button class="nav-btn" id="prevBtn" onclick="prevPage()" disabled aria-label="Go to previous page">Previous</button>
            <div style="display: flex; gap: 10px;">
                <span style="color: #666;">Page Navigation:</span>
                <span id="pageIndicator">1 of 11</span>
            </div>
            <button class="nav-btn" id="nextBtn" onclick="nextPage()" aria-label="Go to next page">Next</button>
        </div>
    </div>

    <script>
/* --------------------------------------------------------
   Simulator Functions
---------------------------------------------------------*/
let simCounter = 0;

function incrementCounter() {
  simCounter++;
  document.getElementById('simCounter').textContent = `Count: ${simCounter}`;
}

function decrementCounter() {
  simCounter--;
  document.getElementById('simCounter').textContent = `Count: ${simCounter}`;
}

function resetCounter() {
  simCounter = 0;
  document.getElementById('simCounter').textContent = `Count: ${simCounter}`;
}

function updateGreeting() {
  const name = document.getElementById('nameInput').value;
  document.getElementById('greeting').textContent = `Hello, ${name}!`;
}

function clearName() {
  document.getElementById('nameInput').value = '';
  document.getElementById('greeting').textContent = 'Hello, !';
}

function updateProfile() {
  const firstName = document.getElementById('firstNameInput').value;
  const lastName = document.getElementById('lastNameInput').value;
  const display = document.getElementById('profileDisplay');
  if (firstName || lastName) {
    display.innerHTML = `
      <strong>Profile Preview:</strong><br>
      Name: ${firstName} ${lastName}<br>
      Status: ${firstName && lastName ? 'Complete' : 'Incomplete'}
    `;
  } else {
    display.textContent = 'Complete your profile';
  }
}

function updateColor() {
  const red = document.getElementById('redSlider').value;
  const green = document.getElementById('greenSlider').value;
  const blue = document.getElementById('blueSlider').value;
  document.getElementById('redValue').textContent = red;
  document.getElementById('greenValue').textContent = green;
  document.getElementById('blueValue').textContent = blue;
  const color = `rgb(${red}, ${green}, ${blue})`;
  document.getElementById('colorPreview').style.background = color;
  const hex = `#${parseInt(red).toString(16).padStart(2, '0')}${parseInt(green).toString(16).padStart(2, '0')}${parseInt(blue).toString(16).padStart(2, '0')}`;
  document.getElementById('hexDisplay').textContent = hex.toUpperCase();
}

function randomizeColor() {
  const red = Math.floor(Math.random() * 256);
  const green = Math.floor(Math.random() * 256);
  const blue = Math.floor(Math.random() * 256);
  document.getElementById('redSlider').value = red;
  document.getElementById('greenSlider').value = green;
  document.getElementById('blueSlider').value = blue;
  updateColor();
}

/* --------------------------------------------------------
   LMS Assessment Logic (Self-contained)
---------------------------------------------------------*/
(function(){
  const QUIZ_KEY = 'lms:state';
  const SETTINGS_KEY = QUIZ_KEY + ':settings';
  const RESULTS_KEY = QUIZ_KEY + ':results';
  const STARTS_KEY = QUIZ_KEY + ':starts';

  const defaultSettings = {
    title: 'SwiftUI State & Interactivity Quiz',
    startISO: '',
    endISO: '',
    durationMin: 30,
    accessCode: 'swift123',
    instructorCode: 'teach789',
    maxAttempts: '3'
  };

  const correctAnswers = { q1: 'b', q2: 'b', q3: 'c', q4: 'c' };

  let timerId = null;
  let remainingSec = 0;
  let activeStudent = null;
  let currentRole = null;

  const $ = sel => document.querySelector(sel);
  const $all = sel => Array.from(document.querySelectorAll(sel));

  const getJSON = (key, fallback) => {
    try { const v = JSON.parse(localStorage.getItem(key) || ''); return (v == null ? fallback : v); } catch { return fallback; }
  };
  const setJSON = (key, value) => localStorage.setItem(key, JSON.stringify(value));

  const loadSettings = () => Object.assign({}, defaultSettings, getJSON(SETTINGS_KEY, {}));
  const saveSettings = (s) => setJSON(SETTINGS_KEY, s);

  const fmt = (sec) => `${String(Math.floor(sec/60)).padStart(2,'0')}:${String(sec%60).padStart(2,'0')}`;

  function isWithinWindow(){
    const s = loadSettings();
    const now = new Date();
    if (s.startISO) {
      const start = new Date(s.startISO);
      if (now < start) return { ok: false, msg: `Quiz will open on ${start.toLocaleString()}.` };
    }
    if (s.endISO) {
      const end = new Date(s.endISO);
      if (now > end) return { ok: false, msg: `Quiz closed on ${end.toLocaleString()}.` };
    }
    return { ok: true, msg: '' };
  }

  function applySettingsToUI(){
    const s = loadSettings();
    const q = $('#quizTitle'); if (q) q.value = s.title;
    const d = $('#duration'); if (d) d.value = s.durationMin;
    const ap = $('#accessPassword'); if (ap) ap.value = s.accessCode;
    const ic = $('#instructorCode'); if (ic) ic.value = s.instructorCode;
    const ma = $('#maxAttempts'); if (ma) ma.value = s.maxAttempts;
    const sd = $('#startDate'); if (sd && s.startISO) sd.value = s.startISO;
    const ed = $('#endDate'); if (ed && s.endISO) ed.value = s.endISO;
  }

  function toggleSettings(){ 
    if (currentRole !== 'instructor') return;
    const sp = $('#settingsPanel'); 
    if (sp) sp.classList.toggle('hidden'); 
    console.log('Settings panel toggled');
  }
  window.toggleSettings = toggleSettings;

  function saveAssessmentSettings(){
    if (currentRole !== 'instructor') return alert('Only instructors can save settings.');
    const s = loadSettings();
    s.title = ($('#quizTitle')?.value || '').trim() || defaultSettings.title;
    s.durationMin = Math.max(5, Math.min(180, Number($('#duration')?.value || defaultSettings.durationMin)));
    s.startISO = $('#startDate')?.value || '';
    s.endISO = $('#endDate')?.value || '';
    s.accessCode = ($('#accessPassword')?.value || '').trim() || defaultSettings.accessCode;
    s.instructorCode = ($('#instructorCode')?.value || '').trim() || defaultSettings.instructorCode;
    s.maxAttempts = $('#maxAttempts')?.value || '3';
    saveSettings(s);
    applySettingsToUI();
    alert('Settings saved.');
  }
  window.saveAssessmentSettings = saveAssessmentSettings;

  function selectStudentRole() {
    currentRole = 'student';
    document.getElementById('roleSelection').classList.add('hidden');
    document.getElementById('lmsContainer').classList.remove('hidden');
    document.getElementById('facultyPanel').classList.add('hidden');
    document.getElementById('studentPanel').classList.remove('hidden');
    document.getElementById('lmsContainer').style.gridTemplateColumns = '1fr';
    console.log('Student role selected');
  }
  window.selectStudentRole = selectStudentRole;

  function selectInstructorRole() {
    const s = loadSettings();
    const password = prompt('Enter instructor password:');
    if (password !== s.instructorCode) {
      alert('Incorrect instructor password.');
      return;
    }
    currentRole = 'instructor';
    document.getElementById('roleSelection').classList.add('hidden');
    document.getElementById('lmsContainer').classList.remove('hidden');
    document.getElementById('studentPanel').classList.add('hidden');
    document.getElementById('facultyPanel').classList.remove('hidden');
    document.getElementById('lmsContainer').style.gridTemplateColumns = '1fr';
    document.getElementById('settingsPanel').classList.remove('hidden');
    console.log('Instructor role selected');
  }
  window.selectInstructorRole = selectInstructorRole;

  const attemptsFor = (name) => getJSON(RESULTS_KEY, []).filter(r => (r.name || '').toLowerCase() === (name || '').toLowerCase()).length;
  const trackStart = () => { const a = getJSON(STARTS_KEY, []); a.push(Date.now()); setJSON(STARTS_KEY, a); };

  function startAssessment(){
    const name = ($('#studentName')?.value || '').trim();
    const pwd = ($('#studentPassword')?.value || '').trim();
    const s = loadSettings();

    if (!name) return alert('Please enter your full name.');
    const gate = isWithinWindow(); 
    if (!gate.ok) return alert(gate.msg);
    if (pwd !== s.accessCode) return alert('Invalid access code.');

    if (s.maxAttempts !== 'unlimited' && attemptsFor(name) >= Number(s.maxAttempts)) {
      return alert(`You have reached the maximum attempts (${s.maxAttempts}).`);
    }

    activeStudent = name;
    const ls = $('#loginSection'); if (ls) ls.classList.add('hidden');
    const rs = $('#resultsSection'); if (rs) rs.classList.add('hidden');
    const qs = $('#quizSection'); if (qs) qs.classList.remove('hidden');

    ['q1', 'q2', 'q3', 'q4'].forEach(q => $all(`input[name="${q}"]`).forEach(el => el.checked = false));

    remainingSec = (Number(s.durationMin) || 30) * 60;
    const timerEl = $('#timer'); if (timerEl) timerEl.textContent = fmt(remainingSec);
    const statusEl = $('#quizStatus'); if (statusEl) statusEl.textContent = `Quiz Active ‚Äì Good luck, ${activeStudent.split(' ')[0]}!`;

    if (timerId) clearInterval(timerId);
    timerId = setInterval(() => {
      remainingSec--;
      if (timerEl) timerEl.textContent = fmt(Math.max(0, remainingSec));
      if (remainingSec <= 0) { clearInterval(timerId); timerId = null; submitAssessment(true); }
    }, 1000);

    trackStart();
  }
  window.startAssessment = startAssessment;

  function computeScore(){
    const sel = (q) => (document.querySelector(`input[name="${q}"]:checked`) || {}).value || '';
    const selections = { q1: sel('q1'), q2: sel('q2'), q3: sel('q3'), q4: sel('q4') };
    let correctCount = 0;
    const detail = {};
    Object.keys(correctAnswers).forEach(k => {
      const ok = selections[k] === correctAnswers[k];
      detail[k] = { ok };
      if (ok) correctCount++;
    });
    return { total: 4, correct: correctCount, detail };
  }

  function submitAssessment(auto = false){
    if (!activeStudent) return alert('No active student session. Please start the quiz.');
    const res = computeScore();
    if (timerId) { clearInterval(timerId); timerId = null; }

    const results = getJSON(RESULTS_KEY, []);
    results.push({ name: activeStudent, correct: res.correct, total: res.total, detail: res.detail, ts: Date.now() });
    setJSON(RESULTS_KEY, results);

    const pct = Math.round((res.correct / res.total) * 100);
    const scoreEl = $('#scoreDisplay');
    if (scoreEl) {
      scoreEl.textContent = `Your Score: ${res.correct}/${res.total} (${pct}%)`;
      scoreEl.style.background = pct >= 70 ? '#48bb78' : '#ed8936';
    }

    const labels = [
      '@State property wrapper',
      'Data binding with $ symbol',
      'TextField keyboard types',
      'Button syntax and actions'
    ];
    const dr = $('#detailedResults');
    if (dr) dr.innerHTML = ['q1', 'q2', 'q3', 'q4'].map((k, i) => `<p>Q${i + 1}: ${res.detail[k].ok ? '‚úì' : '‚úó'} ${labels[i]}</p>`).join('');

    const recs = [];
    if (!res.detail.q1.ok) recs.push('Review @State property wrapper basics.');
    if (!res.detail.q2.ok) recs.push('Practice data binding with $ symbol.');
    if (!res.detail.q3.ok) recs.push('Study TextField modifiers and keyboard types.');
    if (!res.detail.q4.ok) recs.push('Practice Button syntax and event handling.');
    const sr = $('#studyRecommendations');
    if (sr) sr.innerHTML = (recs.length ? recs : ['Excellent work! Continue with advanced SwiftUI concepts.']).map(r => `<li>${r}</li>`).join('');

    const s = loadSettings();
    const used = attemptsFor(activeStudent);
    const btn = $('#retakeBtn');
    if (btn) {
      if (s.maxAttempts === 'unlimited') {
        btn.textContent = 'Retake Quiz (Unlimited)';
        btn.disabled = false;
        btn.classList.remove('hidden');
      } else {
        const max = Number(s.maxAttempts);
        if (used >= max) { btn.textContent = `No more attempts (${used}/${max})`; btn.disabled = true; }
        else { btn.textContent = `Retake Quiz (${used}/${max})`; btn.disabled = false; }
        btn.classList.remove('hidden');
      }
    }

    const qs = $('#quizSection'); if (qs) qs.classList.add('hidden');
    const rs = $('#resultsSection'); if (rs) rs.classList.remove('hidden');

    updateInstructorDashboard();
    if (auto) alert('Time is up! Your quiz was submitted automatically.');
  }
  window.submitAssessment = submitAssessment;

  function retakeAssessment(){
    const s = loadSettings();
    if (!activeStudent) { return alert('No active student session. Please start the quiz.'); }
    const used = attemptsFor(activeStudent);
    if (s.maxAttempts !== 'unlimited' && used >= Number(s.maxAttempts)) return alert('No attempts remaining.');

    ['q1', 'q2', 'q3', 'q4'].forEach(q => $all(`input[name="${q}"]`).forEach(el => el.checked = false));
    const rs = $('#resultsSection'); if (rs) rs.classList.add('hidden');
    const qs = $('#quizSection'); if (qs) qs.classList.remove('hidden');

    remainingSec = (Number(s.durationMin) || 30) * 60;
    const timerEl = $('#timer'); if (timerEl) timerEl.textContent = fmt(remainingSec);
    const statusEl = $('#quizStatus'); if (statusEl) statusEl.textContent = `Quiz Active ‚Äì Attempt ${used + 1}`;

    if (timerId) clearInterval(timerId);
    timerId = setInterval(() => {
      remainingSec--;
      if (timerEl) timerEl.textContent = fmt(Math.max(0, remainingSec));
      if (remainingSec <= 0) { clearInterval(timerId); timerId = null; submitAssessment(true); }
    }, 1000);

    const starts = getJSON(STARTS_KEY, []);
    starts.push(Date.now()); setJSON(STARTS_KEY, starts);
  }
  window.retakeAssessment = retakeAssessment;

  function updateInstructorDashboard(){
    if (currentRole !== 'instructor') return;
    const results = getJSON(RESULTS_KEY, []);
    const starts = getJSON(STARTS_KEY, []);
    const attempts = results.length;
    const avg = attempts ? Math.round(results.reduce((a, r) => a + (r.correct / r.total) * 100, 0) / attempts) : 0;
    const completionRate = starts.length ? Math.round((attempts / starts.length) * 100) : (attempts ? 100 : 0);

    const ac = $('#attemptCount'); if (ac) ac.textContent = attempts;
    const as = $('#averageScore'); if (as) as.textContent = `${avg}%`;
    const cr = $('#completionRate'); if (cr) cr.textContent = `${completionRate}%`;
    const pf = $('#progressFill'); if (pf) pf.style.width = `${completionRate}%`;

    const byQ = {
      q1: { ok: 0, n: 0, l: 'Q1 - @State Basics' },
      q2: { ok: 0, n: 0, l: 'Q2 - Button Actions' },
      q3: { ok: 0, n: 0, l: 'Q3 - TextField Binding' },
      q4: { ok: 0, n: 0, l: 'Q4 - Data Binding' }
    };
    results.forEach(r => Object.keys(byQ).forEach(k => { byQ[k].n++; if (r.detail?.[k]?.ok) byQ[k].ok++; }));
    const qs = $('#questionStats');
    if (qs) qs.innerHTML = Object.values(byQ).map(q => `<p>${q.l}: <strong>${q.n ? Math.round(100 * q.ok / q.n) : 0}% correct</strong></p>`).join('');
  }
  window.updateInstructorDashboard = updateInstructorDashboard;

  document.addEventListener('DOMContentLoaded', () => {
    const sd = $('#startDate'); 
    const ed = $('#endDate');
    if (sd && !sd.value) sd.value = new Date().toISOString().slice(0, 16);
    if (ed && !ed.value) ed.value = new Date(Date.now() + 60 * 60 * 1000).toISOString().slice(0, 16);
    applySettingsToUI();
    updateInstructorDashboard();
    document.getElementById('lmsDate').textContent = new Date().toLocaleString('en-US', { month: 'numeric', day: 'numeric', year: 'numeric', hour: 'numeric', minute: '2-digit', second: '2-digit', hour12: true }).replace(', ', ' ');
  });

  applySettingsToUI();
  updateInstructorDashboard();
})();

/* --------------------------------------------------------
   Pager (Prev / Next / Jump)
---------------------------------------------------------*/
(function(){
  const pages = Array.from(document.querySelectorAll('.page'));
  const totalPages = 11;
  let currentPageNum = 1;

  function setActive(id){
    try {
      console.log('setActive called with id:', id);
      pages.forEach(p => { p.classList.remove('active'); p.style.display = 'none'; });
      const el = document.getElementById(id);
      if (!el) {
        console.error('Page not found:', id);
        return;
      }
      el.classList.add('active');
      el.style.display = 'block';
      currentPageNum = Number(id.replace('page', '')) || 1;
      
      const currentPageEl = document.getElementById('currentPage');
      const pageIndicatorEl = document.getElementById('pageIndicator');
      if (currentPageEl) currentPageEl.textContent = currentPageNum;
      if (pageIndicatorEl) pageIndicatorEl.textContent = `${currentPageNum} of ${totalPages}`;
      
      const prevBtn = document.getElementById('prevBtn');
      const nextBtn = document.getElementById('nextBtn');
      if (prevBtn) prevBtn.disabled = currentPageNum === 1;
      if (nextBtn) nextBtn.disabled = currentPageNum === totalPages;
      
      updateSimulator();
      location.hash = id;
    } catch (error) {
      console.error('Error in setActive:', error);
    }
  }

  function currentIndex(){
    const act = document.querySelector('.page.active');
    if (act) return Number(act.id.replace('page', '')) || 1;
    const fromHash = (location.hash || '').replace('#', '');
    if (fromHash && document.getElementById(fromHash)) return Number(fromHash.replace('page', '')) || 1;
    return 1;
  }

  function updateSimulator() {
    try {
      console.log('updateSimulator called for page:', currentPageNum);
      document.querySelectorAll('.sim-demo').forEach(demo => {
        demo.style.display = 'none';
      });
      const simulatorContent = document.getElementById('simulatorContent');
      if (currentPageNum <= 2) {
        document.getElementById('sim1').style.display = 'block';
      } else if (currentPageNum <= 4) {
        document.getElementById('sim2').style.display = 'block';
      } else if (currentPageNum <= 6) {
        document.getElementById('sim3').style.display = 'block';
      } else if (currentPageNum <= 10) {
        document.getElementById('sim4').style.display = 'block';
      } else {
        simulatorContent.innerHTML = `
          <h4 style="color: #4ECDC4; text-align: center;">LMS Features</h4>
          <div style="color: #4ECDC4; padding: 15px; text-align: center;">
            <p>‚úÖ Quiz Creation & Management</p>
            <p>üìÖ Date/Time Controls</p>
            <p>üîê Password Protection</p>
            <p>üìä Real-time Analytics</p>
            <p>üéØ Performance Tracking</p>
            <p>üîÑ Multiple Attempts</p>
            <p>üìà Progress Visualization</p>
            <p>üí° Study Recommendations</p>
          </div>
        `;
      }
    } catch (error) {
      console.error('Error in updateSimulator:', error);
    }
  }

  window.nextPage = () => { 
    console.log('nextPage called, currentPageNum:', currentPageNum);
    const i = currentIndex();
    if (i < totalPages) {
      setActive('page' + (i + 1));
    }
  };

  window.prevPage = () => { 
    console.log('prevPage called, currentPageNum:', currentPageNum);
    const i = currentIndex();
    if (i > 1) {
      setActive('page' + (i - 1));
    }
  };

  const boot = () => {
    console.log('Booting pager');
    const fromHash = (location.hash || '').replace('#', '');
    if (fromHash && document.getElementById(fromHash)) {
      setActive(fromHash);
    } else {
      setActive('page1');
    }
  };

  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', boot);
  } else {
    boot();
  }
})();

/* --------------------------------------------------------
   Keyboard Navigation
---------------------------------------------------------*/
document.addEventListener('keydown', (e) => {
  if (e.key === 'ArrowRight') {
    nextPage();
  } else if (e.key === 'ArrowLeft') {
    prevPage();
  }
});
    </script>
</body>
</html>
